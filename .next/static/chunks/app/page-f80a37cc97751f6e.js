(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2714:(e,s,t)=>{"use strict";t.d(s,{J:()=>o});var a=t(5155),r=t(2115),n=t(968),l=t(2085),i=t(3999);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.b,{ref:s,className:(0,i.cn)(d(),t),...r})});o.displayName=n.b.displayName},3381:(e,s,t)=>{Promise.resolve().then(t.bind(t,5835))},4503:(e,s,t)=>{"use strict";t.d(s,{dj:()=>u});var a=t(2115);let r=0,n=new Map,l=e=>{if(n.has(e))return;let s=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,s)},i=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function m(e){let{...s}=e,t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=a.useState(o);return a.useEffect(()=>(d.push(s),()=>{let e=d.indexOf(s);e>-1&&d.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},5835:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>au});var a=t(5155),r=t(2115),n=t(5695),l=t(3274),i=t(3783),d=t(5657),o=t(7580),c=t(1007),m=t(4516),u=t(9397),x=t(4835),h=t(9314),p=t(7168),g=t(2785),j=t(3509),f=t(7650),v=t(3999);let N=e=>{let{className:s}=e,[t,n]=(0,r.useState)(!1),l=(0,r.useRef)(null),i=async()=>{if(!l.current)return;await document.startViewTransition(()=>{(0,f.flushSync)(()=>{n(document.documentElement.classList.toggle("dark"))})}).ready;let{top:e,left:s,width:t,height:a}=l.current.getBoundingClientRect(),r=e+a/2,i=s+t/2,d=window.innerWidth-s,o=window.innerHeight-e,c=Math.hypot(Math.max(s,d),Math.max(e,o));document.documentElement.animate({clipPath:["circle(0px at ".concat(i,"px ").concat(r,"px)"),"circle(".concat(c,"px at ").concat(i,"px ").concat(r,"px)")]},{duration:700,easing:"ease-in-out",pseudoElement:"::view-transition-new(root)"})};return(0,a.jsx)("button",{ref:l,onClick:i,className:(0,v.cn)(s),children:t?(0,a.jsx)(g.A,{}):(0,a.jsx)(j.A,{})})};function y(){return(0,a.jsx)(N,{})}let b=[{id:"overview",title:"Overview",icon:i.A},{id:"robots",title:"Robot Status",icon:d.A},{id:"patients",title:"Patient Management",icon:o.A},{id:"nurses",title:"Nurse Management",icon:c.A},{id:"management",title:"Infrastructure Management",icon:o.A},{id:"map",title:"Map Management",icon:m.A}];function w(e){let{user:s,onLogout:t,activeView:r,setActiveView:n}=e;return(0,a.jsxs)(h.Bx,{children:[(0,a.jsx)(h.Gh,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between px-2 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-[#9d4ec3]/10 dark:bg-[#9d4ec3]/20 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"w-4 h-4 text-[#9d4ec3]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-semibold dark:text-white",children:"MedBot Admin"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Welcome, ",s.name]})]})]}),(0,a.jsx)(y,{})]})}),(0,a.jsx)(h.Yv,{children:(0,a.jsx)(h.Cn,{children:(0,a.jsx)(h.rQ,{children:(0,a.jsx)(h.wZ,{children:b.map(e=>(0,a.jsx)(h.FX,{children:(0,a.jsxs)(h.Uj,{onClick:()=>n(e.id),isActive:r===e.id,className:"w-full justify-start",children:[(0,a.jsx)(e.icon,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.title})]})},e.id))})})})}),(0,a.jsx)(h.CG,{children:(0,a.jsxs)(p.$,{variant:"ghost",onClick:t,className:"w-full justify-start text-muted-foreground hover:text-foreground",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]})}var A=t(8274),_=t(9114);let S=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,v.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});S.displayName="Card";let C=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,v.cn)("flex flex-col space-y-1.5 p-6",t),...r})});C.displayName="CardHeader";let k=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,v.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});k.displayName="CardTitle";let E=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,v.cn)("text-sm text-muted-foreground",t),...r})});E.displayName="CardDescription";let F=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,v.cn)("p-6 pt-0",t),...r})});F.displayName="CardContent";let R=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,v.cn)("flex items-center p-6 pt-0",t),...r})});R.displayName="CardFooter";var L=t(5863);let P=r.forwardRef((e,s)=>{let{className:t,value:r,...n}=e;return(0,a.jsx)(L.bL,{ref:s,className:(0,v.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:(0,a.jsx)(L.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});P.displayName=L.bL.displayName;let D=(0,t(2085).F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function I(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,v.cn)(D({variant:t}),s),...r})}var q=t(7737),O=t(5339),M=t(6474),T=t(7265),U=t(4992),$=t(1539),K=t(9302),z=t(1243),B=t(232),V=t(537),Q=t(5838),J=t(6715),W=t(5041),Y=t(6671),H=t(2002);async function G(){let{data:e}=await H.A.get("robot_management/all-robot-telemetry/");return e.data[0]}async function Z(){let{data:e}=await H.A.get("robot_management/active/alerts/"),s=null==e?void 0:e.data;return Array.isArray(s)?s:null==s?[]:[s]}async function X(e,s){try{let{data:t}=await H.A.patch("robot_management/alerts/".concat(e,"/update-reason/"),{reason:s});return t.data}catch(e){throw console.error("Failed to update alert reason:",e),e}}async function ee(){var e;let{data:s}=await H.A.get("robot_management/failed-schedules/"),t=null==s?void 0:null===(e=s.results)||void 0===e?void 0:e.data;return Array.isArray(t)?t:[]}async function es(e){let{data:s}=await H.A.put("robot_management/failed-schedules/".concat(e,"/"),{responded:!0});return s.data}function et(){return(0,Q.I)({queryKey:["robot-telemetry"],queryFn:G,refetchInterval:2e3})}let ea=function(e){let{url:s,parse:t=e=>e,autoConnect:a=!0,maxReconnectAttempts:n=10,reconnectInterval:l=1e3}=e,i=(0,r.useRef)(null),d=(0,r.useRef)(0),o=(0,r.useRef)(null),[c,m]=(0,r.useState)({data:null,isLoading:!!a,error:null}),u=(0,r.useCallback)(()=>{if(!i.current)try{let e=new WebSocket(s);i.current=e,m(e=>({...e,isLoading:!0,error:null})),e.onopen=()=>{d.current=0,m(e=>({...e,isLoading:!1}))},e.onmessage=e=>{try{let s=e.data,a=s.lastIndexOf("}");-1!==a&&(s=s.substring(0,a+1));let r=JSON.parse(s),n=t(r);null!=n&&m({data:n,isLoading:!1,error:null})}catch(s){console.error("Failed to parse WebSocket message:",e.data,s),m(e=>({...e,error:Error("Failed to parse message")}))}},e.onclose=()=>{if(i.current=null,d.current<n){let e=l*Math.pow(2,d.current);d.current+=1,o.current=window.setTimeout(()=>{u()},e)}else m(e=>({...e,error:Error("Max reconnect attempts reached")}))},e.onerror=e=>{m(e=>({...e,error:Error("WebSocket error")}))}}catch(e){m(s=>({...s,error:e,isLoading:!1}))}},[s,t,n,l]),x=(0,r.useCallback)(()=>{if(o.current&&(clearTimeout(o.current),o.current=null),i.current){try{i.current.close()}catch(e){}i.current=null}},[]);return(0,r.useEffect)(()=>(a&&u(),()=>{x()}),[u,x,a]),{...c,reconnect:u,disconnect:x}},er=e=>(null==e?void 0:e.payload)===!0;function en(e){let{wsUrl:s,fetcher:t}=e,[a,n]=(0,r.useState)({data:null,isLoading:!0,error:null}),l=ea({url:s,parse:er}),i=(0,r.useCallback)(async()=>{n(e=>({...e,isLoading:!0}));try{let e=await t();n({data:e,isLoading:!1,error:null})}catch(e){n({data:null,isLoading:!1,error:e})}},[t]);return(0,r.useEffect)(()=>{i()},[i]),(0,r.useEffect)(()=>{!0===l.data&&(console.log("Trigger received from ".concat(s,", refetching data...")),i())},[l.data,i,s]),a}async function el(){let{data:e}=await H.A.get("robot_management/arm-endpose/");return e.data}async function ei(){let{data:e}=await H.A.get("robot_management/joint-velocity/");return e.data}async function ed(){let{data:e}=await H.A.get("robot_management/joint-effort/");return e.data}async function eo(){let{data:e}=await H.A.get("robot_management/joint-position/");return e.data}async function ec(){let{data:e}=await H.A.get("robot_management/joint-position/");return e.data}async function em(){let{data:e}=await H.A.get("robot_management/get-joint-status/");return e.data}async function eu(){let{data:e}=await H.A.get("robot_management/get-arm-status/");return e.data}var ex=t(9509);let eh=e=>{let s=ex.env.NEXT_PUBLIC_WS_URL||"ws://192.168.1.27:8001";return"".concat(s,"/ws/socket-server/").concat(e)},ep=e=>{if(e&&"connection_established"===e.Type)return console.log("Received connection status message:",e),null;if(e&&e.payload){let s=e.payload;return void 0!==s.j1?{joint_1:s.j1,joint_2:s.j2,joint_3:s.j3,joint_4:s.j4,joint_5:s.j5,joint_6:s.j6}:s}return null};function eg(e,s){let{data:t,...a}=ea({url:eh(e),parse:ep}),[n,l]=(0,r.useState)(null),[i,d]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{s().then(l).catch(s=>console.error("Failed to fetch API data for ".concat(e),s)).finally(()=>d(!1))},[s,e]),{data:null!=t?t:n,isLoading:i&&!t,...a}}let ej={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},ef=e=>{let{icon:s,title:t,value:r,subtitle:n,color:l="blue",progress:i,alert:d=!1,isLoading:o=!1}=e,c={red:{bg:"bg-red-50 dark:bg-red-950/40",border:"border-red-200 dark:border-red-800",iconBg:"bg-red-100 dark:bg-red-900",iconColor:"text-red-600 dark:text-red-300",progress:"[&>div]:bg-red-500"},orange:{bg:"bg-orange-50 dark:bg-orange-950/40",border:"border-orange-200 dark:border-orange-800",iconBg:"bg-orange-100 dark:bg-orange-900",iconColor:"text-orange-600 dark:text-orange-300",progress:"[&>div]:bg-orange-500"},green:{bg:"bg-green-50 dark:bg-green-950/40",border:"border-green-200 dark:border-green-800",iconBg:"bg-green-100 dark:bg-green-900",iconColor:"text-green-600 dark:text-green-300",progress:"[&>div]:bg-green-500"},purple:{bg:"bg-purple-50 dark:bg-purple-950/40",border:"border-purple-200 dark:border-purple-800",iconBg:"bg-purple-100 dark:bg-purple-900",iconColor:"text-purple-600 dark:text-purple-300",progress:"[&>div]:bg-purple-500"},blue:{bg:"bg-blue-50 dark:bg-blue-950/40",border:"border-blue-200 dark:border-blue-800",iconBg:"bg-blue-100 dark:bg-blue-900",iconColor:"text-blue-600 dark:text-blue-300",progress:"[&>div]:bg-blue-500"}},m=d&&c.red?c.red:c[l]||c.blue;return(0,a.jsx)(A.P.div,{variants:ej,whileHover:"hover",className:"h-full",children:(0,a.jsx)(S,{className:"relative overflow-hidden border shadow-sm hover:shadow-md transition-all duration-300 h-full ".concat(m.bg," ").concat(m.border),children:(0,a.jsxs)(F,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsx)("div",{className:"p-3 rounded-xl ".concat(m.iconBg),children:(0,a.jsx)(s,{className:"w-5 h-5 ".concat(m.iconColor)})}),d&&(0,a.jsxs)(I,{variant:"destructive",className:"flex items-center gap-1",children:[(0,a.jsx)(O.A,{className:"w-3 h-3"})," Alert"]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:t}),o?(0,a.jsx)(q.E,{className:"h-8 w-24"}):(0,a.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-foreground",children:r}),n&&"string"==typeof n&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:n}),n&&"string"!=typeof n&&n]}),null!=i&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(P,{value:Math.max(0,Math.min(100,i)),className:"h-2 ".concat(m.progress)}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:[i,"% capacity"]})]})]})]})})})},ev=e=>{let{title:s,data:t,icon:n,color:l="blue",description:i,isLoading:d=!1}=e,[o,c]=(0,r.useState)(!1),m={green:{bg:"bg-green-100",color:"text-green-600"},purple:{bg:"bg-purple-100",color:"text-purple-600"},orange:{bg:"bg-orange-100",color:"text-orange-600"},blue:{bg:"bg-blue-100",color:"text-blue-600"}},u=(0,r.useMemo)(()=>t?Object.fromEntries(Object.entries(t).filter(e=>{let[s]=e;return!s.includes("_timestamp")&&!["id","created_at"].includes(s)})):null,[t]),x=m[l]||m.blue;return(0,a.jsx)(A.P.div,{variants:ej,whileHover:"hover",children:(0,a.jsxs)(S,{className:"shadow-sm border hover:shadow-md transition-all duration-300 overflow-hidden",children:[(0,a.jsx)(C,{className:"cursor-pointer bg-muted/30 hover:bg-muted/50 transition-colors p-4",onClick:()=>c(!o),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2.5 rounded-lg ".concat(x.bg),children:(0,a.jsx)(n,{className:"w-4 h-4 ".concat(x.color)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{className:"text-base font-semibold",children:s}),(0,a.jsx)(E,{className:"text-sm mt-1",children:i})]})]}),(0,a.jsx)(A.P.div,{animate:{rotate:180*!!o},transition:{duration:.2},children:(0,a.jsx)(M.A,{className:"w-4 h-4 text-muted-foreground"})})]})}),(0,a.jsx)(_.N,{children:o&&(0,a.jsx)(A.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:(0,a.jsx)(F,{className:"p-4 pt-0",children:d?(0,a.jsx)("div",{className:"space-y-2",children:Array.from({length:4}).map((e,s)=>(0,a.jsx)(q.E,{className:"h-10 w-full"},s))}):(0,a.jsx)("div",{className:"grid gap-2",children:u&&Object.entries(u).map((e,s)=>{let[t,r]=e;return(0,a.jsxs)(A.P.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.05*s},className:"flex justify-between items-center py-2.5 px-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-foreground capitalize",children:t.replace(/_/g," ")}),(0,a.jsx)("span",{className:"text-sm font-mono bg-background px-2.5 py-1 rounded border text-foreground",children:"number"==typeof r?r.toFixed(3):String(r)})]},t)})})})})})]})})},eN=e=>{let{label:s,value:t,isLoading:r=!1}=e,n="TRUE"===String(t).toUpperCase(),l={"Voltage Too Low":T.A,"Motor Overheating":U.A,"Driver Overcurrent":$.A,"Driver Overheating":U.A,"Sensor Status":K.A,"Driver Error Status":z.A}[s]||B.A;return r?(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(q.E,{className:"w-4 h-4 rounded-full"}),(0,a.jsx)(q.E,{className:"h-4 w-32"})]}),(0,a.jsx)(q.E,{className:"h-6 w-16 rounded-md"})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(l,{className:"w-4 h-4 ".concat(n?"text-red-500":"text-muted-foreground")}),(0,a.jsx)("span",{className:"text-sm font-medium text-foreground",children:s})]}),(0,a.jsx)(I,{variant:n?"destructive":"secondary",className:"capitalize",children:String(t).toLowerCase()})]})},ey=e=>{let{status:s,isLoading:t=!1}=e;if(!s&&!t)return null;let r={"Arm Status":null==s?void 0:s.arm_status,"Control Mode":null==s?void 0:s.ctrl_mode,"Motion Status":null==s?void 0:s.motion_status,"Homing Status":null==s?void 0:s.homing_status},n={"Voltage Too Low":null==s?void 0:s.voltage_too_low,"Motor Overheating":null==s?void 0:s.motor_overheating,"Driver Overcurrent":null==s?void 0:s.driver_overcurrent,"Driver Overheating":null==s?void 0:s.driver_overheating,"Sensor Status":null==s?void 0:s.sensor_status,"Driver Error Status":null==s?void 0:s.driver_error_status};return(0,a.jsx)(A.P.div,{variants:ej,children:(0,a.jsxs)(S,{className:"shadow-sm border hover:shadow-md transition-all duration-300",children:[(0,a.jsx)(C,{className:"bg-muted/30 pb-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2.5 bg-purple-100 rounded-lg",children:(0,a.jsx)(B.A,{className:"w-5 h-5 text-purple-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{className:"text-lg font-semibold",children:"Arm System Status"}),(0,a.jsx)(E,{className:"mt-1",children:"Overall health and operational state"})]})]})}),(0,a.jsxs)(F,{className:"p-6 grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-muted-foreground mb-3",children:"Operational State"}),t?Array.from({length:4}).map((e,s)=>(0,a.jsx)(eN,{isLoading:!0,label:"loading-".concat(s),value:""},s)):Object.entries(r).map(e=>{let[s,t]=e;return(0,a.jsx)(eN,{label:s,value:t},s)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-muted-foreground mb-3",children:"System Health & Alerts"}),t?Array.from({length:6}).map((e,s)=>(0,a.jsx)(eN,{isLoading:!0,label:"loading-".concat(s),value:""},s)):Object.entries(n).map(e=>{let[s,t]=e;return(0,a.jsx)(eN,{label:s,value:t},s)})]})]})]})})};function eb(){var e,s,t;let{data:r,isLoading:n}=et(),{data:l,isLoading:i}=eg("arm-endpose-value/",el),{data:o,isLoading:c}=eg("joint-velocity-value/",ei),{data:x,isLoading:h}=eg("joint-effort-value/",ed),{data:p,isLoading:g}=eg("joint-position-value/",eo),{data:j,isLoading:f}=en({wsUrl:eh("refresh-arm-data-value/"),fetcher:eu}),{data:v,isLoading:N}=en({wsUrl:eh("refresh-joint-data-value/"),fetcher:em}),{data:y,isLoading:b}=eg("joint-heat-value/",ec);return(0,a.jsx)("div",{className:"bg-muted/20 px-4 md:px-0 lg:px-8 py-6",children:(0,a.jsxs)("div",{className:"mx-auto space-y-6 ",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Robot Dashboard"}),(0,a.jsx)("p",{className:"text-base text-muted-foreground mt-2",children:"Real-time monitoring & intelligent control"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(ef,{icon:d.A,title:"Robot Name",value:(null==r?void 0:r.robot_name)||"â€”",color:"blue",isLoading:n,subtitle:"",progress:null,alert:null}),(0,a.jsx)(ef,{icon:V.A,title:"Battery Level",value:"".concat(null!==(e=null==r?void 0:r.robot_battery)&&void 0!==e?e:0,"%"),progress:null!==(s=null==r?void 0:r.robot_battery)&&void 0!==s?s:0,color:void 0===(t=null==r?void 0:r.robot_battery)?"blue":t<30?"red":t<60?"orange":"green",isLoading:n,subtitle:"",alert:null}),(0,a.jsx)(ef,{icon:m.A,title:"Location",value:(null==r?void 0:r.latest_room_reached)||"Unknown",color:"purple",isLoading:n,subtitle:"",progress:null,alert:null})]}),(0,a.jsx)(ey,{status:j,isLoading:f}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)(ev,{title:"Joint Position",data:p,icon:u.A,color:"green",description:"Current joint angles",isLoading:g}),(0,a.jsx)(ev,{title:"Joint Effort",data:x,icon:$.A,color:"orange",description:"Applied torque/force",isLoading:h}),(0,a.jsx)(ev,{title:"Joint Temperature",data:y,icon:U.A,color:"orange",description:"Live joint temperatures",isLoading:b})]})]})})}var ew=t(9145);async function eA(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,{data:t}=await H.A.get("/main/view-all-patient/?page=".concat(e,"&page_size=").concat(s));return t}async function e_(e){let{data:s}=await H.A.post("/main/create-patient/",e);return s}async function eS(e){let{data:s}=await H.A.delete("/main/delete-patient/".concat(e,"/"));return s}async function eC(){let{data:e}=await H.A.get("schedule/view-all-scheduled-slots/");return e.data}async function ek(){let{data:e}=await H.A.get("/schedule/view-active-slot-patient/");return e}let eE=async(e,s)=>{let{data:t}=await H.A.post("/main/assign-bed-room/",{slot_assigned:s,patient_id:e});return t},eF=async(e,s)=>{let t=new FormData;t.append("patient",String(e)),t.append("batch",String(s));let{data:a}=await H.A.put("schedule/schedule-slots/",t);return a},eR=async(e,s)=>{let t=new FormData;t.append("patient",String(e)),t.append("batch",String(s));let{data:a}=await H.A.post("schedule/check-scheduled-slot/",t);return a};async function eL(e){let{data:s}=await H.A.delete("/schedule/remove/scheduled-slot/",{data:{slot_id:e}});return s}let eP=async e=>{let s=new FormData;s.append("file",e,"patients_data.xlsx");let{data:t}=await H.A.post("main/import_patients_excel/",s);return t},eD=async()=>(await H.A.get("main/export_patients_excel/",{responseType:"blob"})).data,eI=async()=>{let{data:e}=await H.A.get("schedule/view-all-batch-schedule/");return e.data},eq=async e=>{let s=new FormData;Object.entries(e).forEach(e=>{let[t,a]=e;null!=a&&s.append(t,String(a))});let{data:t}=await H.A.post("schedule/add-batch-schedule/",s);return t},eO=async e=>{let s=new FormData;s.append("file",e,"patients_data.xlsx");let{data:t}=await H.A.post("schedule/import_batch_schedules_excel/",s);return t},eM=async()=>(await H.A.get("schedule/export_batch_schedules_excel/",{responseType:"blob"})).data,eT=async e=>{let{data:s}=await H.A.post("schedule/swap/scheduled/slots/",e);return s},eU=async e=>{let s=new FormData;s.append("room_pos_a",String(e.room_pos_a)),s.append("room_pos_b",String(e.room_pos_b)),s.append("batch_id",String(e.batch_id));let{data:t}=await H.A.post("schedule/swap-room-order-scheduled-slot/",s);return t};function e$(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>eP(e),onSuccess:s=>{Y.oR.success(s.message||"Excel uploaded successfully!"),e.invalidateQueries({queryKey:["patients"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to upload Excel.")}})}function eK(){return(0,W.n)({mutationFn:()=>eD(),onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to download Excel.")},onSuccess:e=>{let s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="patients_data.xlsx",t.addEventListener("click",()=>{Y.oR.success("Download started!")}),document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(s)}})}var ez=t(9852),eB=t(2714),eV=t(5452),eQ=t(4416);let eJ=eV.bL,eW=eV.l9,eY=eV.ZL,eH=eV.bm,eG=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eV.hJ,{ref:s,className:(0,v.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r})});eG.displayName=eV.hJ.displayName;let eZ=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(eY,{children:[(0,a.jsx)(eG,{}),(0,a.jsxs)(eV.UC,{ref:s,className:(0,v.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[r,(0,a.jsxs)(eV.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(eQ.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});eZ.displayName=eV.UC.displayName;let eX=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,v.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};eX.displayName="DialogHeader";let e0=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,v.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};e0.displayName="DialogFooter";let e4=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eV.hE,{ref:s,className:(0,v.cn)("text-lg font-semibold leading-none tracking-tight",t),...r})});e4.displayName=eV.hE.displayName;let e2=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(eV.VY,{ref:s,className:(0,v.cn)("text-sm text-muted-foreground",t),...r})});e2.displayName=eV.VY.displayName;var e1=t(2376),e3=t(7863),e5=t(5196);let e6=e1.bL;e1.YJ;let e8=e1.WT,e9=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(e1.l9,{ref:s,className:(0,v.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,a.jsx)(e1.In,{asChild:!0,children:(0,a.jsx)(M.A,{className:"h-4 w-4 opacity-50"})})]})});e9.displayName=e1.l9.displayName;let e7=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e1.PP,{ref:s,className:(0,v.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(e3.A,{className:"h-4 w-4"})})});e7.displayName=e1.PP.displayName;let se=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e1.wn,{ref:s,className:(0,v.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,a.jsx)(M.A,{className:"h-4 w-4"})})});se.displayName=e1.wn.displayName;let ss=r.forwardRef((e,s)=>{let{className:t,children:r,position:n="popper",...l}=e;return(0,a.jsx)(e1.ZL,{children:(0,a.jsxs)(e1.UC,{ref:s,className:(0,v.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,a.jsx)(e7,{}),(0,a.jsx)(e1.LM,{className:(0,v.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(se,{})]})})});ss.displayName=e1.UC.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e1.JU,{ref:s,className:(0,v.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=e1.JU.displayName;let st=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(e1.q7,{ref:s,className:(0,v.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(e1.VF,{children:(0,a.jsx)(e5.A,{className:"h-4 w-4"})})}),(0,a.jsx)(e1.p4,{children:r})]})});st.displayName=e1.q7.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(e1.wv,{ref:s,className:(0,v.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=e1.wv.displayName;var sa=t(1154),sr=t(4616),sn=t(9074),sl=t(3717),si=t(6643),sd=t(9629);let so=async e=>{let{data:s}=await H.A.post("bed/data/slot/create/",e);return s},sc=async()=>{let{data:e}=await H.A.get("bed/data/slot/all/");return e},sm=async e=>{let{data:s}=await H.A.delete("bed/data/slot/delete/".concat(e,"/"));return s},su=async e=>{let{data:s}=await H.I.post("/webhook/trigger-slot-position/",{slot_id:e});return s};function sx(){let e=(0,J.jE)(),s=(0,Q.I)({queryKey:["slots"],queryFn:sc,select:e=>e.data}),t=(0,W.n)({mutationFn:e=>so(e),onSuccess:()=>{e.invalidateQueries({queryKey:["slots"]})}}),a=(0,W.n)({mutationFn:e=>sm(e),onSuccess:()=>{e.invalidateQueries({queryKey:["slots"]})}}),r=(0,W.n)({mutationFn:e=>su(e),onSuccess:()=>{e.invalidateQueries({queryKey:["slots"]})}});return{slots:s.data,isLoadingSlots:s.isLoading,createSlot:t.mutateAsync,deleteSlot:a.mutateAsync,markPosition:r.mutateAsync,markingSlotId:r.variables,isMarking:r.isPending}}var sh=t(7923),sp=t(3052),sg=t(9428);let sj=sh.bL,sf=sh.l9;sh.YJ,sh.ZL,sh.Pb,sh.z6,r.forwardRef((e,s)=>{let{className:t,inset:r,children:n,...l}=e;return(0,a.jsxs)(sh.ZP,{ref:s,className:(0,v.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",t),...l,children:[n,(0,a.jsx)(sp.A,{className:"ml-auto h-4 w-4"})]})}).displayName=sh.ZP.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sh.G5,{ref:s,className:(0,v.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}).displayName=sh.G5.displayName;let sv=r.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...n}=e;return(0,a.jsx)(sh.ZL,{children:(0,a.jsx)(sh.UC,{ref:s,sideOffset:r,className:(0,v.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});sv.displayName=sh.UC.displayName;let sN=r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(sh.q7,{ref:s,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",t),...n})});sN.displayName=sh.q7.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,checked:n,...l}=e;return(0,a.jsxs)(sh.H_,{ref:s,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(sh.VF,{children:(0,a.jsx)(e5.A,{className:"h-4 w-4"})})}),r]})}).displayName=sh.H_.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(sh.hN,{ref:s,className:(0,v.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(sh.VF,{children:(0,a.jsx)(sg.A,{className:"h-2 w-2 fill-current"})})}),r]})}).displayName=sh.hN.displayName,r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(sh.JU,{ref:s,className:(0,v.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",t),...n})}).displayName=sh.JU.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(sh.wv,{ref:s,className:(0,v.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=sh.wv.displayName;var sy=t(5623),sb=t(9869),sw=t(1788),sA=t(4503);function s_(e){let{uploadHook:s,downloadHook:t,buttonLabel:n="Manage Excel"}=e,[l,i]=(0,r.useState)(!1),{toast:d}=(0,sA.dj)(),{mutateAsync:o,isLoading:c}=s(),{mutateAsync:m,isLoading:u}=t(),x=async e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(t)try{i(!0);let e=await t.arrayBuffer(),s=new Blob([e],{type:t.type});await o(s),d({title:"Success",description:"Excel uploaded successfully!"})}catch(e){console.error(e),d({title:"Error",description:"Failed to upload Excel file.",variant:"destructive"})}finally{i(!1)}};return(0,a.jsxs)("div",{className:"flex gap-4 p-4",children:[(0,a.jsx)(ez.p,{id:"upload-excel",type:"file",accept:".xlsx, .xls",onChange:x,className:"hidden"}),(0,a.jsxs)(sj,{children:[(0,a.jsx)(sf,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",className:"flex items-center gap-2",children:[n,(0,a.jsx)(sy.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(sv,{align:"start",className:"w-52",children:[(0,a.jsxs)(sN,{onClick:()=>{var e;return null===(e=document.getElementById("upload-excel"))||void 0===e?void 0:e.click()},children:[c?(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(sb.A,{className:"h-4 w-4"}),c?"Uploading...":"Upload Excel"]}),(0,a.jsxs)(sN,{onClick:()=>m(),children:[u?(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(sw.A,{className:"h-4 w-4"}),u?"Downloading...":"Download Excel"]})]})]})]})}let sS=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",sC=e=>{if(!e||0===e.length)return"PAT-001";let s=e.reduce((e,s)=>{let t=parseInt(s.patient_id.replace(/[^0-9]/g,""),10);return!isNaN(t)&&t>e?t:e},0);return"PAT-".concat(String(s+1).padStart(3,"0"))},sk={name:"",age:"",gender:"male",patient_id:""};function sE(){var e;let{data:s,isLoading:t,hasNextPage:n,fetchNextPage:l,isFetchingNextPage:i}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;return(0,ew.q)({queryKey:["patients",e],queryFn:s=>{let{pageParam:t=1}=s;return eA(t,e)},initialPageParam:1,getNextPageParam:e=>{if(e.next)try{return Number(new URL(e.next).searchParams.get("page"))}catch(e){return}}})}(),d=(0,r.useMemo)(()=>{var e;return null!==(e=null==s?void 0:s.pages.flatMap(e=>e.results.data).filter(Boolean))&&void 0!==e?e:[]},[s]),o=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>e_(e),onSuccess:s=>{Y.oR.success(s.message||"Patient saved successfully!"),e.invalidateQueries({queryKey:["patients"]})},onError:e=>{Y.oR.error(e.message||"An unexpected error occurred.")}})}(),c=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>eS(e),onSuccess:s=>{Y.oR.success(s.message||"Patient status updated."),e.invalidateQueries({queryKey:["patients"]})},onError:e=>{Y.oR.error(e.message||"Failed to update patient status.")}})}(),m=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>{let{patientId:s,slotId:t}=e;return eE(s,t)},onSuccess:s=>{Y.oR.success(s.message||"Slot assigned successfully!"),e.invalidateQueries({queryKey:["patients"]}),e.invalidateQueries({queryKey:["slots"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to assign slot.")}})}(),{slots:u}=sx(),[x,h]=(0,r.useState)(!1),[g,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(null),[N,y]=(0,r.useState)(null),[b,w]=(0,r.useState)(null),[A,_]=(0,r.useState)(sk),L=(0,r.useRef)(null),P=(0,r.useRef)(null),D=null!==f,q=(0,r.useCallback)(e=>{let[s]=e;s.isIntersecting&&n&&!i&&l()},[n,i,l]);(0,r.useEffect)(()=>{let e=L.current;if(e)return P.current&&P.current.disconnect(),P.current=new IntersectionObserver(q,{root:null,rootMargin:"100px",threshold:.1}),P.current.observe(e),()=>{P.current&&P.current.disconnect()}},[q]),(0,r.useEffect)(()=>{x&&f&&_({name:f.name,age:String(f.age),gender:f.gender,patient_id:f.patient_id})},[f,x]);let O=e=>{let{id:s,value:t}=e.target;_(e=>({...e,[s]:t}))},M=e=>{v(e),h(!0)},U=e=>{y(e),w(null),j(!0)};return t?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}),"Loading patients..."]})}):(0,a.jsxs)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Patient Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"A centralized view of all patient records."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(p.$,{onClick:()=>{let e=sC(d);v(null),_({...sk,patient_id:e}),h(!0)},className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:[(0,a.jsx)(sr.A,{className:"w-4 h-4 mr-2"})," Add Patient"]}),(0,a.jsx)(s_,{uploadHook:e$,downloadHook:eK,buttonLabel:"Manage Excel"})]})]}),(0,a.jsx)(eJ,{open:x,onOpenChange:h,children:(0,a.jsxs)(eZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:D?"Edit Patient":"Add New Patient"}),(0,a.jsx)(e2,{children:D?"Update the patient's details below.":"Fill in the details below to add a new patient record."})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"patient_id",className:"text-right",children:"Patient ID"}),(0,a.jsx)(ez.p,{id:"patient_id",value:A.patient_id,className:"col-span-3",disabled:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"name",className:"text-right",children:"Name *"}),(0,a.jsx)(ez.p,{id:"name",value:A.name,onChange:O,placeholder:"Enter patient name",className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"age",className:"text-right",children:"Age *"}),(0,a.jsx)(ez.p,{id:"age",type:"number",value:A.age,onChange:O,placeholder:"Enter age",className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"gender",className:"text-right",children:"Gender"}),(0,a.jsxs)(e6,{value:A.gender,onValueChange:e=>{_(s=>({...s,gender:e}))},children:[(0,a.jsx)(e9,{className:"col-span-3",children:(0,a.jsx)(e8,{placeholder:"Select gender"})}),(0,a.jsxs)(ss,{children:[(0,a.jsx)(st,{value:"male",children:"Male"}),(0,a.jsx)(st,{value:"female",children:"Female"}),(0,a.jsx)(st,{value:"transgender",children:"Transgender"})]})]})]})]}),(0,a.jsx)(e0,{children:(0,a.jsx)(p.$,{onClick:()=>{if(!A.name||!A.age){Y.oR.warning("Please fill in all required fields.");return}let e={...A,age:Number(A.age),gender:A.gender,...D&&{id:f.id}};o.mutate(e,{onSuccess:()=>{h(!1),v(null)}})},className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",disabled:o.isPending,children:o.isPending?D?"Saving...":"Adding...":D?"Save Changes":"Add Patient"})})]})}),(0,a.jsx)(eJ,{open:g,onOpenChange:j,children:(0,a.jsxs)(eZ,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:"Assign Slot"}),(0,a.jsxs)(e2,{children:["Assign a bed/room slot to patient"," ",(0,a.jsx)("span",{className:"font-semibold",children:null==N?void 0:N.name}),"."]})]}),(0,a.jsxs)(e6,{onValueChange:e=>w(Number(e)),children:[(0,a.jsx)(e9,{children:(0,a.jsx)(e8,{placeholder:"Select a slot"})}),(0,a.jsx)(ss,{children:null==u?void 0:null===(e=u.filter(e=>e.is_active))||void 0===e?void 0:e.map(e=>{var s,t;return(0,a.jsxs)(st,{value:String(e.id),children:[null!==(t=null===(s=e.room_name)||void 0===s?void 0:s.room_name)&&void 0!==t?t:"N/A"," -"," ",e.bed_name.bed_name]},e.id)})})]}),(0,a.jsx)(e0,{children:(0,a.jsx)(p.$,{onClick:()=>{if(!N||!b){Y.oR.warning("Please select a slot.");return}m.mutate({patientId:N.id,slotId:b},{onSuccess:()=>j(!1)})},disabled:m.isPending,children:m.isPending?"Assigning...":"Assign Slot"})})]})}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:d.map(e=>{var s;return(0,a.jsxs)(S,{className:"flex flex-col justify-between",children:[(0,a.jsxs)(C,{children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{className:"text-xl",children:null!==(s=null==e?void 0:e.name)&&void 0!==s?s:"Unnamed Patient"}),(0,a.jsxs)(E,{children:[e.age," years old"]})]}),(0,a.jsx)(I,{variant:"outline",className:e.is_active?"bg-green-100 text-green-800 border-green-300":"bg-gray-100 text-gray-800 border-gray-300",children:e.is_active?"Active":"Inactive"})]}),(0,a.jsxs)("p",{className:"pt-2 text-xs text-muted-foreground",children:["Patient ID: ",e.patient_id]}),e.slot_assigned?(0,a.jsxs)("p",{className:"pt-2 text-xs text-muted-foreground",children:["Bed: ",e.slot_assigned.bed_name,", Room:"," ",e.slot_assigned.room_name]}):(0,a.jsx)("p",{className:"pt-2 text-red-600 italic text-muted-foreground",children:"No slot assigned"})]}),(0,a.jsx)(F,{children:(0,a.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,a.jsx)(sn.A,{className:"w-4 h-4 mr-2"}),(0,a.jsxs)("span",{children:["Admitted: ",sS(e.created_at)]})]})}),(0,a.jsx)(R,{className:"pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex w-full gap-2 flex-wrap",children:[(0,a.jsxs)(p.$,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>M(e),children:[(0,a.jsx)(sl.A,{className:"w-3 h-3 mr-1"})," Edit"]}),(0,a.jsxs)(p.$,{variant:"secondary",size:"sm",className:"flex-1",onClick:()=>U(e),children:[(0,a.jsx)(si.A,{className:"w-3 h-3 mr-1"})," Assign Slot"]}),(0,a.jsxs)(p.$,{variant:e.is_active?"destructive":"default",size:"sm",className:"flex-1",disabled:c.isPending&&c.variables===e.id,onClick:()=>c.mutate(e.id),children:[e.is_active?(0,a.jsx)(sd.A,{className:"w-3 h-3 mr-1"}):(0,a.jsx)(T.A,{className:"w-3 h-3 mr-1"}),c.isPending&&c.variables===e.id?"Updating...":e.is_active?"Deactivate":"Activate"]})]})})]},e.id)})}),n&&(0,a.jsx)("div",{ref:L,className:"flex justify-center items-center py-8",children:i?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"w-4 h-4 animate-spin"}),"Loading more patients..."]}):(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Scroll down to load more patients"})}),!n&&d.length>0&&(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"You've reached the end of the patient list"})})]})}var sF=t(9772),sR=t(1264),sL=t(9420),sP=t(9446),sD=t(5670);async function sI(e){let{data:s}=await H.A.post("/main/create-admin/",e);return s}async function sq(e){let{data:s}=await H.A.post("/main/create-admin/",e);return s}async function sO(){let{data:e}=await H.A.get("/main/view-all-admin/nurse/");return e.data}async function sM(e){let{data:s}=await H.A.delete("/main/delete-admin/".concat(e,"/"));return s}let sT={username:"",password:"",name:"",email:"",role:"nurse",gender:"female"};function sU(){return(0,a.jsxs)(S,{children:[(0,a.jsx)(C,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(q.E,{className:"w-10 h-10 rounded-full"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(q.E,{className:"h-5 w-32 mb-1"}),(0,a.jsx)(q.E,{className:"h-4 w-16"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsx)(q.E,{className:"h-5 w-12"}),(0,a.jsx)(q.E,{className:"h-5 w-16"})]})]})}),(0,a.jsxs)(F,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"pl-1 space-y-2 border-l-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(q.E,{className:"w-4 h-4 ml-2"}),(0,a.jsx)(q.E,{className:"h-4 w-40"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(q.E,{className:"w-4 h-4 ml-2"}),(0,a.jsx)(q.E,{className:"h-4 w-24"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(q.E,{className:"w-4 h-4 ml-2"}),(0,a.jsx)(q.E,{className:"h-4 w-32"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsx)(q.E,{className:"h-8 flex-1"}),(0,a.jsx)(q.E,{className:"h-8 flex-1"})]})]})]})}function s$(){let{data:e,isLoading:s}=(0,Q.I)({queryKey:["nurses"],queryFn:sO}),{mutate:t,isPending:n}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>sI(e),onSuccess:s=>{Y.oR.success(s.message||"Nurse created successfully!"),e.invalidateQueries({queryKey:["nurses"]})},onError:e=>{var s,t;if(null===(s=e.response)||void 0===s?void 0:s.data){let s=e.response.data;(null===(t=s.error)||void 0===t?void 0:t.details)?Object.entries(s.error.details).forEach(e=>{let[s,t]=e;Y.oR.error("".concat(s,": ").concat(t))}):Y.oR.error(s.message||"Something went wrong.")}else Y.oR.error(e.message||"Network error. Please try again.")}})}(),{mutate:l,isPending:i}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>sq(e),onSuccess:s=>{Y.oR.success(s.message||"User updated successfully!"),e.invalidateQueries({queryKey:["nurses"]})},onError:e=>{Y.oR.error("Failed to update nurse. Please try again."),console.error("Update Error:",e)}})}(),{mutate:d}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>sM(e),onMutate:async s=>{await e.cancelQueries({queryKey:["nurses"]});let t=e.getQueryData(["nurses"]);return e.setQueryData(["nurses"],e=>e?e.map(e=>e.id===s?{...e,is_active:!e.is_active}:e):[]),{prevNurses:t}},onSuccess:e=>{Y.oR.success(e.message||"Status updated successfully!")},onError:(s,t,a)=>{var r,n;(null==a?void 0:a.prevNurses)&&e.setQueryData(["nurses"],a.prevNurses),(null===(n=s.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)?Y.oR.error(s.response.data.message):Y.oR.error("Failed to update nurse status. Please try again.")},onSettled:()=>{e.invalidateQueries({queryKey:["nurses"]})}})}(),[o,c]=(0,r.useState)(sT),[m,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[g,j]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),N=e=>{h(!0),j(e.id),c({username:e.username,name:e.name,email:e.email,role:e.role,gender:e.gender,password:""}),u(!0)},y=()=>{h(!1),c(sT),u(!0)},b=e=>{v(e),d(e,{onSuccess:()=>v(null),onError:()=>v(null)})};if((0,r.useEffect)(()=>{m||(h(!1),j(null),c(sT))},[m]),s)return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(q.E,{className:"h-8 w-48 mb-2"}),(0,a.jsx)(q.E,{className:"h-4 w-64"})]}),(0,a.jsx)(q.E,{className:"h-10 w-32"})]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((e,s)=>(0,a.jsx)(sU,{},s))})]});let w=n||i;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Nurse Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage nurse accounts and assignments"})]}),(0,a.jsxs)(eJ,{open:m,onOpenChange:u,children:[(0,a.jsx)(eW,{asChild:!0,children:(0,a.jsxs)(p.$,{onClick:y,className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:[(0,a.jsx)(sr.A,{className:"w-4 h-4 mr-2"}),"Add Nurse"]})}),(0,a.jsxs)(eZ,{className:"sm:max-w-[480px]",children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:x?"Edit Nurse":"Add New Nurse"}),(0,a.jsx)(e2,{children:x?"Update the details for this nurse.":"Fill in the details below to create a new nurse account."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!o.username||!o.email||!o.name){Y.oR.warning("Please fill in all required fields.");return}if(x&&g)l({id:g,username:o.username,name:o.name,email:o.email,role:o.role,gender:o.gender,...o.password&&{password:o.password}},{onSuccess:()=>u(!1)});else{if(!o.password){Y.oR.warning("Password is required for new users.");return}t(o,{onSuccess:()=>u(!1)})}},children:[(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid items-center grid-cols-4 gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"name",className:"text-right",children:"Full Name *"}),(0,a.jsx)(ez.p,{id:"name",value:o.name,onChange:e=>c({...o,name:e.target.value}),className:"col-span-3",placeholder:"e.g. Florence Nightingale",required:!0})]}),(0,a.jsxs)("div",{className:"grid items-center grid-cols-4 gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"email",className:"text-right",children:"Email *"}),(0,a.jsx)(ez.p,{id:"email",type:"email",value:o.email,onChange:e=>c({...o,email:e.target.value}),className:"col-span-3",placeholder:"nurse@example.com",required:!0})]}),(0,a.jsxs)("div",{className:"grid items-center grid-cols-4 gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"username",className:"text-right",children:"Username *"}),(0,a.jsx)(ez.p,{id:"username",value:o.username,onChange:e=>c({...o,username:e.target.value}),className:"col-span-3",placeholder:"Enter username",required:!0})]}),(0,a.jsxs)("div",{className:"grid items-center grid-cols-4 gap-4",children:[(0,a.jsxs)(eB.J,{htmlFor:"password",className:"text-right",children:["Password ",x?"":"*"]}),(0,a.jsx)(ez.p,{id:"password",type:"password",value:o.password,onChange:e=>c({...o,password:e.target.value}),className:"col-span-3",placeholder:x?"Leave blank to keep unchanged":"Enter secure password",required:!x})]}),(0,a.jsxs)("div",{className:"grid items-center grid-cols-4 gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"role",className:"text-right",children:"Role"}),(0,a.jsxs)(e6,{value:o.role,onValueChange:e=>c({...o,role:e}),children:[(0,a.jsx)(e9,{className:"col-span-3",children:(0,a.jsx)(e8,{placeholder:"Select role"})}),(0,a.jsxs)(ss,{children:[(0,a.jsx)(st,{value:"nurse",children:"Nurse"}),(0,a.jsx)(st,{value:"admin",children:"Admin"})]})]})]}),(0,a.jsxs)("div",{className:"grid items-center grid-cols-4 gap-4",children:[(0,a.jsx)(eB.J,{htmlFor:"gender",className:"text-right",children:"Gender"}),(0,a.jsxs)(e6,{value:o.gender,onValueChange:e=>c({...o,gender:e}),children:[(0,a.jsx)(e9,{className:"col-span-3",children:(0,a.jsx)(e8,{placeholder:"Select gender"})}),(0,a.jsxs)(ss,{children:[(0,a.jsx)(st,{value:"female",children:"Female"}),(0,a.jsx)(st,{value:"male",children:"Male"})]})]})]})]}),(0,a.jsxs)(e0,{children:[(0,a.jsx)(eH,{asChild:!0,children:(0,a.jsx)(p.$,{type:"button",variant:"outline",children:"Cancel"})}),(0,a.jsxs)(p.$,{type:"submit",disabled:w,children:[w&&(0,a.jsx)(sa.A,{className:"w-4 h-4 mr-2 animate-spin"}),w?x?"Saving...":"Adding...":x?"Save Changes":"Add Nurse"]})]})]})]})]})]}),(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:null==e?void 0:e.map(e=>{var s;return(0,a.jsxs)(S,{className:"".concat(e.is_active?"":"opacity-60 border-dashed"),children:[(0,a.jsx)(C,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 rounded-full bg-muted",children:(0,a.jsx)(sF.A,{className:"w-6 h-6 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{className:"text-lg flex items-center gap-2",children:e.name}),(0,a.jsxs)(E,{children:["ID:",e.id]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,a.jsx)(I,{variant:"admin"===e.role?"default":"secondary",children:e.role}),(0,a.jsx)(I,{variant:e.is_active?"default":"destructive",className:"bg-green-600",children:e.is_active?"Active":"Inactive"})]})]})}),(0,a.jsxs)(F,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"pl-1 space-y-2 border-l-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(sR.A,{className:"w-4 h-4 ml-2 text-muted-foreground"}),(0,a.jsx)("span",{className:"truncate",children:e.email})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(sL.A,{className:"w-4 h-4 ml-2 text-muted-foreground"}),(0,a.jsx)("span",{children:null!==(s=e.phone)&&void 0!==s?s:"N/A"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(sn.A,{className:"w-4 h-4 ml-2 text-muted-foreground"}),(0,a.jsxs)("span",{children:["Joined: ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,a.jsxs)(p.$,{variant:"outline",size:"sm",className:"flex-1 bg-transparent",onClick:()=>N(e),children:[(0,a.jsx)(sl.A,{className:"w-3 h-3 mr-1.5"})," Edit"]}),(0,a.jsxs)(p.$,{size:"sm",variant:e.is_active?"destructive":"default",className:"flex-1",onClick:()=>b(e.id),disabled:f===e.id,children:[f===e.id?(0,a.jsx)(sa.A,{className:"w-3 h-3 mr-1.5 animate-spin"}):e.is_active?(0,a.jsx)(sP.A,{className:"w-3 h-3 mr-1.5"}):(0,a.jsx)(sD.A,{className:"w-3 h-3 mr-1.5"}),e.is_active?"Deactivate":"Activate"]})]})]})]},e.id)})}),(null==e?void 0:e.length)===0&&!s&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(sF.A,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No nurses found"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Get started by adding your first nurse account."}),(0,a.jsxs)(p.$,{onClick:y,className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:[(0,a.jsx)(sr.A,{className:"w-4 h-4 mr-2"}),"Add First Nurse"]})]})]})}var sK=t(3578),sz=t(646),sB=t(7434),sV=t(2525);let sQ=async()=>(await H.A.get("robot_management/maps/getsert/")).data,sJ=async e=>(await H.A.delete("robot_management/maps/".concat(e,"/delete/"))).data,sW=async e=>(await H.A.put("robot_management/maps/activate-map/".concat(e,"/"))).data;function sY(){let{maps:e,isLoading:s,isError:t,error:n}=function(){var e;let s=(0,Q.I)({queryKey:["maps"],queryFn:sQ,staleTime:3e5});return{maps:(null===(e=s.data)||void 0===e?void 0:e.data)||[],isLoading:s.isLoading,isError:s.isError,error:s.error,refetch:s.refetch}}(),{mutate:l,isPending:i}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:sW,onSuccess:s=>{Y.oR.success(s.message||"Map activated successfully."),e.invalidateQueries({queryKey:["maps"]})},onError:e=>{Y.oR.error(e.message||"Failed to activate map.")}})}(),{mutate:d,isPending:o}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:sJ,onSuccess:s=>{Y.oR.success(s.message||"Map deleted successfully."),e.invalidateQueries({queryKey:["maps"]})},onError:e=>{Y.oR.error(e.message||"Failed to delete map.")}})}(),[c,m]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),h=e=>{m(e),l(e,{onSettled:()=>{m(null)}})};if(s)return(0,a.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,a.jsx)(sa.A,{className:"w-8 h-8 animate-spin text-muted-foreground"}),(0,a.jsx)("p",{className:"ml-2",children:"Loading Maps..."})]});if(t)return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,a.jsx)(O.A,{className:"w-8 h-8 text-red-500"}),(0,a.jsx)("p",{className:"mt-2 font-semibold text-red-700",children:"Failed to Load Maps"}),(0,a.jsx)("p",{className:"text-sm text-red-600",children:(null==n?void 0:n.message)||"An unknown error occurred."})]});let g=e.find(e=>e.is_active),j=e.filter(e=>!e.is_active);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Map Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Activate or delete robot navigation maps from the available list."})]}),g&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold tracking-tight border-b pb-4 mb-6",children:"Active Map"}),(0,a.jsxs)("div",{className:"p-4 bg-green-50 border-l-4 border-green-500 rounded-lg flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(sK.A,{className:"w-8 h-8 text-green-700"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-900",children:g.map_name}),(0,a.jsxs)("p",{className:"text-sm text-green-800",children:["Created: ",new Date(g.created_at).toLocaleDateString()]})]})]}),(0,a.jsxs)(I,{className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,a.jsx)(sz.A,{className:"w-4 h-4 mr-2"}),"Active"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold tracking-tight border-b pb-4 mb-6",children:["Available Maps (",j.length,")"]}),j.length>0?(0,a.jsx)("div",{className:"space-y-4",children:j.map(e=>(0,a.jsxs)(S,{className:"p-4 flex items-center justify-between transition-shadow hover:shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(sB.A,{className:"w-8 h-8 text-muted-foreground flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{className:"text-lg",children:e.map_name}),(0,a.jsxs)(E,{children:["Created: ",new Date(e.created_at).toLocaleDateString(),(0,a.jsx)("span",{className:"mx-2 text-slate-300",children:"|"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[(0,a.jsxs)(p.$,{variant:"outline",size:"sm",onClick:()=>h(e.id),disabled:i,children:[i&&c===e.id?(0,a.jsx)(sa.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,a.jsx)(T.A,{className:"w-4 h-4 mr-2"}),"Set Active"]}),(0,a.jsx)(p.$,{variant:"outline",size:"icon",onClick:()=>x(e),disabled:i,className:"text-red-600 hover:bg-red-50 hover:text-red-700",children:(0,a.jsx)(sV.A,{className:"w-4 h-4"})})]})]},e.id))}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 text-center py-16 border-2 border-dashed rounded-lg",children:[(0,a.jsx)(sK.A,{className:"w-16 h-16 text-slate-400"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-slate-700",children:"No Other Maps Available"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"When new maps are added, they will appear here."})]})]})]})]}),(0,a.jsx)(eJ,{open:!!u,onOpenChange:e=>!e&&x(null),children:(0,a.jsxs)(eZ,{children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:"Confirm Deletion"}),(0,a.jsxs)(e2,{children:["Are you sure you want to delete the map: ",(0,a.jsx)("span",{className:"font-semibold",children:null==u?void 0:u.map_name}),"? This action cannot be undone."]})]}),(0,a.jsxs)(e0,{children:[(0,a.jsx)(eH,{asChild:!0,children:(0,a.jsx)(p.$,{variant:"outline",disabled:o,children:"Cancel"})}),(0,a.jsxs)(p.$,{variant:"destructive",onClick:()=>{u&&d(u.id,{onSuccess:()=>{x(null)}})},disabled:o,children:[o&&(0,a.jsx)(sa.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Delete"]})]})]})})]})}var sH=t(2177),sG=t(221),sZ=t(927);let sX=async e=>{let{data:s}=await H.A.post("bed/data/room/create/",{count:e});return s},s0=async()=>{let{data:e}=await H.A.get("bed/data/room/all/");return e},s4=async e=>{let{data:s}=await H.A.post("bed/data/bed/create/",{count:e});return s},s2=async()=>{let{data:e}=await H.A.get("bed/data/bed/all/");return e};var s1=t(9708);let s3=sH.Op,s5=r.createContext({}),s6=e=>{let{...s}=e;return(0,a.jsx)(s5.Provider,{value:{name:s.name},children:(0,a.jsx)(sH.xI,{...s})})},s8=()=>{let e=r.useContext(s5),s=r.useContext(s9),{getFieldState:t,formState:a}=(0,sH.xW)(),n=t(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=s;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},s9=r.createContext({}),s7=r.forwardRef((e,s)=>{let{className:t,...n}=e,l=r.useId();return(0,a.jsx)(s9.Provider,{value:{id:l},children:(0,a.jsx)("div",{ref:s,className:(0,v.cn)("space-y-2",t),...n})})});s7.displayName="FormItem";let te=r.forwardRef((e,s)=>{let{className:t,...r}=e,{error:n,formItemId:l}=s8();return(0,a.jsx)(eB.J,{ref:s,className:(0,v.cn)(n&&"text-destructive",t),htmlFor:l,...r})});te.displayName="FormLabel";let ts=r.forwardRef((e,s)=>{let{...t}=e,{error:r,formItemId:n,formDescriptionId:l,formMessageId:i}=s8();return(0,a.jsx)(s1.DX,{ref:s,id:n,"aria-describedby":r?"".concat(l," ").concat(i):"".concat(l),"aria-invalid":!!r,...t})});ts.displayName="FormControl",r.forwardRef((e,s)=>{let{className:t,...r}=e,{formDescriptionId:n}=s8();return(0,a.jsx)("p",{ref:s,id:n,className:(0,v.cn)("text-sm text-muted-foreground",t),...r})}).displayName="FormDescription";let tt=r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e,{error:l,formMessageId:i}=s8(),d=l?String(null==l?void 0:l.message):r;return d?(0,a.jsx)("p",{ref:s,id:i,className:(0,v.cn)("text-sm font-medium text-destructive",t),...n,children:d}):null});tt.displayName="FormMessage";var ta=t(6037),tr=t(9567),tn=t(9103),tl=t(2267),ti=t(8613),td=t(3562),to=t(1284);let tc=sZ.Ik({roomId:sZ.Yj().min(1,"Please select a room."),bedId:sZ.Yj().min(1,"Please select a bed.")}),tm=e=>!0===e||!1!==e&&(1===e||"1"===e||0!==e&&"0"!==e&&"string"==typeof e&&"true"===e.trim().toLowerCase());function tu(){var e,s,t,n,l;let{rooms:i,createRooms:d,isLoadingRooms:o}=function(){let e=(0,J.jE)(),s=(0,Q.I)({queryKey:["rooms"],queryFn:s0,select:e=>e.data}),t=(0,W.n)({mutationFn:sX,onSuccess:()=>{e.invalidateQueries({queryKey:["rooms"]})}});return{rooms:s.data,isLoadingRooms:s.isLoading,createRooms:t.mutateAsync}}(),{beds:c,createBeds:x,isLoadingBeds:h}=function(){let e=(0,J.jE)(),s=(0,Q.I)({queryKey:["beds"],queryFn:s2,select:e=>e.data,refetchOnWindowFocus:!0,refetchInterval:1e4,staleTime:1e3}),t=(0,W.n)({mutationFn:s4,onSuccess:()=>{e.invalidateQueries({queryKey:["beds"]}),e.invalidateQueries({queryKey:["slots"]})}});return{beds:s.data,isLoadingBeds:s.isLoading,isError:s.isError,error:s.error,createBeds:t.mutateAsync,refetch:s.refetch}}(),{slots:g=[],createSlot:j,deleteSlot:f,isLoadingSlots:v,markPosition:N,isMarking:y,markingSlotId:b}=sx(),[w,A]=(0,r.useState)(1),[_,R]=(0,r.useState)(1),[L,P]=(0,r.useState)(!1),[D,q]=(0,r.useState)(!1),[O,M]=(0,r.useState)(!1),[U,$]=(0,r.useState)(null),[K,z]=(0,r.useState)(null),B=(0,sH.mN)({resolver:(0,sG.u)(tc),defaultValues:{roomId:"",bedId:""}}),V=(0,r.useMemo)(()=>(null==g?void 0:g.filter(e=>!!e.room_name))||[],[g]);(0,r.useMemo)(()=>(null==g?void 0:g.filter(e=>!e.room_name))||[],[g]);let H=(0,r.useMemo)(()=>(null==V?void 0:V.filter(e=>tm(e.is_active)))||[],[V]),G=(0,r.useMemo)(()=>(null==V?void 0:V.filter(e=>!tm(e.is_active)))||[],[V]),Z=async()=>{try{await d(w),Y.oR.success("".concat(w," room(s) created successfully!")),A(1),P(!1)}catch(e){Y.oR.error("Failed to create rooms.")}},X=async()=>{try{await x(_),Y.oR.success("".concat(_," bed(s) created successfully!")),R(1),q(!1)}catch(e){Y.oR.error("Failed to create beds.")}},ee=async e=>{try{await j({room_name_id:Number(e.roomId),bed_name_id:Number(e.bedId)}),Y.oR.success("Slot assigned successfully!"),B.reset(),M(!1)}catch(e){Y.oR.error("Failed to assign slot. It may already be assigned.")}},es=async(e,s)=>{$(e);try{await f(e),Y.oR.success("Slot ".concat(s?"deactivated":"activated"," successfully!"))}catch(e){console.error("Toggle slot error:",e),Y.oR.error("Failed to toggle slot status.")}finally{$(null)}},et=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return(0,a.jsx)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("div",{className:"mb-8 pb-2",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-foreground ",children:"Infrastructure Management"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage rooms, beds, and slot assignments efficiently"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)(S,{className:"border-border",children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium text-muted-foreground",children:"Total Rooms"}),(0,a.jsx)("div",{className:"p-2 bg-accent rounded-md",children:(0,a.jsx)(tr.A,{className:"h-4 w-4 text-accent-foreground"})})]}),(0,a.jsxs)(F,{className:"pt-2",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-foreground mb-4",children:o?"...":(null==i?void 0:i.length)||0}),(0,a.jsxs)(eJ,{open:L,onOpenChange:P,children:[(0,a.jsx)(eW,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",size:"sm",className:"w-full",children:[(0,a.jsx)(tn.A,{className:"mr-2 h-4 w-4"}),"Add Rooms"]})}),(0,a.jsxs)(eZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:"Create New Rooms"}),(0,a.jsx)(e2,{children:"Enter the number of rooms you want to create."})]}),(0,a.jsxs)("div",{className:"flex gap-3 py-4",children:[(0,a.jsx)(ez.p,{type:"number",min:1,max:50,value:w,onChange:e=>A(Number(e.target.value)),placeholder:"Number of rooms"}),(0,a.jsx)(p.$,{onClick:Z,disabled:w<1,children:"Create"})]})]})]})]})]}),(0,a.jsxs)(S,{className:"border-border",children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium text-muted-foreground",children:"Total Beds"}),(0,a.jsx)("div",{className:"p-2 bg-accent rounded-md",children:(0,a.jsx)(tl.A,{className:"h-4 w-4 text-accent-foreground"})})]}),(0,a.jsxs)(F,{className:"pt-2",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-foreground mb-4",children:h?"...":(null==c?void 0:c.length)||0}),(0,a.jsxs)(eJ,{open:D,onOpenChange:q,children:[(0,a.jsx)(eW,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",size:"sm",className:"w-full",children:[(0,a.jsx)(tn.A,{className:"mr-2 h-4 w-4"}),"Add Beds"]})}),(0,a.jsxs)(eZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:"Create New Beds"}),(0,a.jsx)(e2,{children:"Enter the number of beds you want to create."})]}),(0,a.jsxs)("div",{className:"flex gap-3 py-4",children:[(0,a.jsx)(ez.p,{type:"number",min:1,max:50,value:_,onChange:e=>R(Number(e.target.value)),placeholder:"Number of beds"}),(0,a.jsx)(p.$,{onClick:X,disabled:_<1,children:"Create"})]})]})]})]})]}),(0,a.jsxs)(S,{className:"border-border",children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium text-muted-foreground",children:"Active Slots"}),(0,a.jsx)("div",{className:"p-2 bg-accent rounded-md",children:(0,a.jsx)(u.A,{className:"h-4 w-4 text-accent-foreground"})})]}),(0,a.jsxs)(F,{className:"pt-2",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:v?"...":(null==H?void 0:H.length)||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Currently active"})]})]}),(0,a.jsxs)(S,{className:"border-border",children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium text-muted-foreground",children:"Total Slots"}),(0,a.jsx)("div",{className:"p-2 bg-accent rounded-md",children:(0,a.jsx)(ti.A,{className:"h-4 w-4 text-accent-foreground"})})]}),(0,a.jsxs)(F,{className:"pt-2",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-foreground",children:v?"...":(null==g?void 0:g.length)||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"Currently total slots"})]})]}),(0,a.jsxs)(S,{className:"   bg-red-50 border border-red-200   dark:bg-red-950/40 dark:border-red-900   ",children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"   text-sm font-medium text-red-700    dark:text-red-300   ",children:"Inactive Slots"}),(0,a.jsx)("div",{className:"   p-2 bg-red-100 rounded-md   dark:bg-red-900/40   ",children:(0,a.jsx)(ti.A,{className:"h-4 w-4 text-red-700 dark:text-red-300"})})]}),(0,a.jsxs)(F,{className:"pt-2",children:[(0,a.jsx)("div",{className:"text-2xl font-semibold text-red-700 dark:text-red-300",children:(null==G?void 0:G.length)||"..."}),(0,a.jsx)("p",{className:"text-xs text-red-600 dark:text-red-400 mt-2",children:"Inactive"})]})]})]}),(0,a.jsx)(C,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{className:"text-xl text-foreground",children:"Bed Assignments"}),(0,a.jsx)(E,{className:"mt-1",children:"Manage room and bed slot assignments"})]}),(0,a.jsxs)(eJ,{open:O,onOpenChange:M,children:[(0,a.jsx)(eW,{asChild:!0,children:(0,a.jsxs)(p.$,{className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:[(0,a.jsx)(tn.A,{className:"mr-2 h-4 w-4"}),"Create slot"]})}),(0,a.jsxs)(eZ,{className:"sm:max-w-md",children:[(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:"Assign a Bed to a Room"}),(0,a.jsx)(e2,{children:"Create a new slot by assigning a bed to a room."})]}),(0,a.jsx)(s3,{...B,children:(0,a.jsxs)("form",{onSubmit:B.handleSubmit(ee),className:"space-y-4 pt-4",children:[(0,a.jsx)(s6,{control:B.control,name:"roomId",render:e=>{let{field:s}=e;return(0,a.jsxs)(s7,{children:[(0,a.jsx)(te,{children:"Room"}),(0,a.jsxs)(e6,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(ts,{children:(0,a.jsx)(e9,{children:(0,a.jsx)(e8,{placeholder:"Select a room"})})}),(0,a.jsx)(ss,{children:null==i?void 0:i.map(e=>(0,a.jsx)(st,{value:String(e.id),children:e.room_name},e.id))})]}),(0,a.jsx)(tt,{})]})}}),(0,a.jsx)(s6,{control:B.control,name:"bedId",render:e=>{let{field:s}=e;return(0,a.jsxs)(s7,{children:[(0,a.jsx)(te,{children:"Bed"}),(0,a.jsxs)(e6,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(ts,{children:(0,a.jsx)(e9,{children:(0,a.jsx)(e8,{placeholder:"Select a bed"})})}),(0,a.jsx)(ss,{children:null==c?void 0:c.map(e=>(0,a.jsxs)(st,{value:String(e.id),disabled:e.is_booked,className:e.is_booked?"text-red-500":"",children:[e.bed_name," ",e.is_booked?"(Booked)":""]},e.id))})]}),(0,a.jsx)(tt,{})]})}}),(0,a.jsx)(p.$,{type:"submit",className:"w-full",children:"Create Assignment"})]})})]})]})]})}),(0,a.jsx)(F,{children:v?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"text-muted-foreground",children:"Loading slots..."})}):0===V.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(ti.A,{className:"mx-auto h-12 w-12 text-muted-foreground/50 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No slots assigned"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Start by assigning beds to rooms."}),(0,a.jsx)(eJ,{open:O,onOpenChange:M,children:(0,a.jsx)(eW,{asChild:!0,children:(0,a.jsxs)(p.$,{children:[(0,a.jsx)(tn.A,{className:"mr-2 h-4 w-4"}),"Assign First Bed"]})})})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:V.map(e=>{var s;let t=tm(e.is_active);return(0,a.jsxs)(S,{className:"relative border-border flex flex-col ".concat(t?"bg-card":"bg-muted/30"),children:[(0,a.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,a.jsx)(I,{variant:t?"default":"secondary",className:"text-xs",children:t?"Active":"Inactive"})}),(0,a.jsxs)(F,{className:"p-6 flex-grow flex flex-col",children:[(0,a.jsxs)("div",{className:"flex-grow space-y-4",children:[(0,a.jsxs)("div",{className:"pr-20",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("h3",{className:"font-medium text-foreground capitalize",children:null===(s=e.room_name)||void 0===s?void 0:s.room_name})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(tl.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("p",{className:"text-foreground font-medium capitalize",children:e.bed_name.bed_name})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(td.A,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Created: ",et(e.created_at)]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-2 pt-1",children:[(0,a.jsx)(sF.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[void 0!==e.x&&void 0!==e.y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"Position:"}),(0,a.jsxs)("span",{className:"pl-2 font-mono text-xs",children:["x: ",Number(e.x).toFixed(4)]}),(0,a.jsxs)("span",{className:"pl-2 font-mono text-xs",children:["y: ",Number(e.y).toFixed(4)]})]}):(0,a.jsx)("span",{children:"Position: Not set"}),void 0!==e.yaw?(0,a.jsxs)("span",{className:"mt-1",children:["Angle: ",Number(e.yaw).toFixed(4)]}):(0,a.jsx)("span",{className:"mt-1",children:"Angle: Not set"})]})]})]})]}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-border",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(p.$,{variant:t?"destructive":"default",size:"sm",className:"h-9 text-sm min-w-0",disabled:U===e.id,onClick:()=>es(e.id,t),children:(0,a.jsx)("div",{className:"flex items-center gap-1.5",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sd.A,{className:"h-3.5 w-3.5"}),(0,a.jsx)("span",{children:"Deactivate"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.A,{className:"h-3.5 w-3.5"}),(0,a.jsx)("span",{children:"Activate"})]})})}),(0,a.jsx)(p.$,{variant:"outline",size:"sm",className:"h-9 text-sm min-w-0",onClick:()=>z(e),children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1.5 w-full",children:[(0,a.jsx)(to.A,{className:"h-3.5 w-3.5 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:"View Details"})]})})]})})]})]},e.id)})})}),(0,a.jsx)(eJ,{open:!!K,onOpenChange:e=>{e||z(null)},children:(0,a.jsxs)(eZ,{className:"sm:max-w-lg",children:[(0,a.jsxs)(eX,{children:[(0,a.jsxs)(e4,{children:["Slot Details: ",null==K?void 0:null===(e=K.room_name)||void 0===e?void 0:e.room_name," / ",null==K?void 0:K.bed_name.bed_name]}),(0,a.jsx)(e2,{children:"Detailed information for the selected slot."})]}),K&&(0,a.jsxs)("div",{className:"py-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status"}),(0,a.jsx)(I,{variant:tm(K.is_active)?"default":"secondary",children:tm(K.is_active)?"Active":"Inactive"})]}),(0,a.jsx)(ta.w,{}),(0,a.jsx)("h4",{className:"font-semibold text-foreground",children:"Position Data (Full Precision)"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm font-mono bg-muted p-3 rounded-md",children:[(0,a.jsxs)("p",{children:["X-coordinate: ",(0,a.jsx)("span",{className:"font-semibold",children:null!==(s=K.x)&&void 0!==s?s:"N/A"})]}),(0,a.jsxs)("p",{children:["Y-coordinate: ",(0,a.jsx)("span",{className:"font-semibold",children:null!==(t=K.y)&&void 0!==t?t:"N/A"})]}),(0,a.jsxs)("p",{children:["Angle (Yaw): ",(0,a.jsx)("span",{className:"font-semibold",children:null!==(n=K.yaw)&&void 0!==n?n:"N/A"})]})]}),(0,a.jsx)(ta.w,{}),(0,a.jsx)("h4",{className:"font-semibold text-foreground",children:"Metadata"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,a.jsxs)("p",{children:["Slot ID: ",(0,a.jsx)("span",{className:"font-medium text-foreground",children:K.id})]}),(0,a.jsxs)("p",{children:["Created On: ",(0,a.jsx)("span",{className:"font-medium text-foreground",children:et(K.created_at)})]}),(0,a.jsxs)("p",{children:["Last Updated: ",(0,a.jsx)("span",{className:"font-medium text-foreground",children:et(K.updated_at)})]}),(0,a.jsxs)("p",{children:["Created By: ",(0,a.jsx)("span",{className:"font-medium text-foreground",children:(l=K.created_by)?l.split(" - ")[0]:"N/A"})]})]})]})]})})]})})}var tx=t(5553),th=t(7649);let tp=th.bL;th.l9;let tg=th.ZL,tj=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(th.hJ,{className:(0,v.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s})});tj.displayName=th.hJ.displayName;let tf=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsxs)(tg,{children:[(0,a.jsx)(tj,{}),(0,a.jsx)(th.UC,{ref:s,className:(0,v.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r})]})});tf.displayName=th.UC.displayName;let tv=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,v.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};tv.displayName="AlertDialogHeader";let tN=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,v.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};tN.displayName="AlertDialogFooter";let ty=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(th.hE,{ref:s,className:(0,v.cn)("text-lg font-semibold",t),...r})});ty.displayName=th.hE.displayName;let tb=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(th.VY,{ref:s,className:(0,v.cn)("text-sm text-muted-foreground",t),...r})});tb.displayName=th.VY.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(th.rc,{ref:s,className:(0,v.cn)((0,p.r)(),t),...r})}).displayName=th.rc.displayName;let tw=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(th.ZD,{ref:s,className:(0,v.cn)((0,p.r)({variant:"outline"}),"mt-2 sm:mt-0",t),...r})});function tA(e){let{isOpen:s,onOpenChange:t,onConfirm:r,title:n,description:l,isConfirming:i=!1}=e;return(0,a.jsx)(tp,{open:s,onOpenChange:t,children:(0,a.jsxs)(tf,{children:[(0,a.jsxs)(tv,{children:[(0,a.jsx)(ty,{children:n}),(0,a.jsx)(tb,{children:l})]}),(0,a.jsxs)(tN,{children:[(0,a.jsx)(tw,{children:"Cancel"}),(0,a.jsx)(p.$,{variant:"destructive",onClick:r,disabled:i,children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(sa.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirming..."]}):"Confirm"})]})]})})}tw.displayName=th.ZD.displayName;var t_=t(3861),tS=t(4186),tC=t(8623);function tk(e){let{title:s}=e,{data:t,isLoading:n,isError:l}=(0,Q.I)({queryKey:["alerts"],queryFn:Z,refetchInterval:6e4}),{data:i,isLoading:d}=et(),c=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>{let{alertId:s,reason:t}=e;return X(s,t)},onSuccess:s=>{Y.oR.success("Alert reason updated successfully!"),e.invalidateQueries({queryKey:["alerts"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to update alert reason.")}})}(),{data:u,isLoading:x}=(0,Q.I)({queryKey:["failedSchedules"],queryFn:ee,refetchInterval:3e4}),h=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>es(e),onSuccess:()=>{Y.oR.success("Schedule acknowledged successfully!"),e.invalidateQueries({queryKey:["failedSchedules"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to acknowledge schedule.")}})}(),[g,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(null),[N,y]=(0,r.useState)(""),[b,w]=(0,r.useState)(5),A=(0,r.useRef)(null),_=async()=>{if(f&&N.trim())try{await c.mutateAsync({alertId:f.id,reason:N}),j(!1),y(""),v(null)}catch(e){console.error("Failed to respond to alert:",e)}},R=(null==t?void 0:t.sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()))||[],L={timedOut:R.filter(e=>e.is_timed_out),help:R.filter(e=>e.is_help),cancelled:R.filter(e=>e.is_cancelled),notMe:R.filter(e=>e.not_me),patientPop:R.filter(e=>e.is_patient_pop),others:R.filter(e=>!e.is_timed_out&&!e.is_help&&!e.is_cancelled&&!e.not_me&&!e.is_patient_pop)},P=(null==u?void 0:u.filter(e=>!e.responded))||[];return(0,a.jsxs)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:s}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Your patients and tasks for today"})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(S,{children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium",children:"Robot"}),(0,a.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==i?void 0:i.robot_name)||"Unknown"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Assigned to you"})]})]}),(0,a.jsxs)(S,{children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium",children:"Battery"}),(0,a.jsx)(sn.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(F,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[(null==i?void 0:i.robot_battery)||0,"%"]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current battery"})]})]}),(0,a.jsxs)(S,{children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium",children:"Alerts"}),(0,a.jsx)(t_.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==t?void 0:t.length)||0}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Requires attention"})]})]}),(0,a.jsxs)(S,{children:[(0,a.jsxs)(C,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(k,{className:"text-sm font-medium",children:"Latest position"}),(0,a.jsx)(tS.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(F,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:(null==i?void 0:i.latest_room_reached)||"Unknown"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Bed: ",(null==i?void 0:i.latest_bed_reached)||"Unknown"]}),(null==i?void 0:i.robot_door_opening)&&(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)(I,{variant:"outline",className:"border-blue-500 text-blue-500 flex items-center gap-1",children:[(0,a.jsx)(tr.A,{className:"h-3 w-3"}),"Door Opening"]})}),(null==i?void 0:i.robot_door_closing)&&(0,a.jsx)("div",{className:"mt-2 flex items-center",children:(0,a.jsxs)(I,{variant:"outline",className:"border-red-500 text-red-500 flex items-center gap-1",children:[(0,a.jsx)(tr.A,{className:"h-3 w-3"}),"Door closing"]})})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(S,{children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(k,{children:"Urgent Alerts"}),(0,a.jsx)(E,{children:"Patients requiring immediate attention"})]}),(0,a.jsx)(F,{ref:A,onScroll:()=>{let e=A.current;e&&t&&e.scrollHeight-e.scrollTop<=e.clientHeight+5&&b<t.length&&w(e=>e+5)},className:"space-y-4 max-h-[350px] overflow-y-auto pr-3",children:Object.entries(L).map(e=>{let[s,t]=e;return t.length>0?(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-md font-semibold mb-2 capitalize",children:s.replace(/([A-Z])/g," $1")}),t.slice(0,b).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("timedOut"===s?"bg-yellow-500":"help"===s?"bg-red-500":"cancelled"===s?"bg-gray-400":"notMe"===s?"bg-blue-400":"patientPop"===s?"bg-purple-500":"bg-green-500")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Room: ",e.room," â€¢ Bed: ",e.bed]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.reason||"No reason provided yet"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsx)(tS.A,{className:"w-3 h-3"}),new Date(e.created_at).toLocaleString()]})]})]}),(0,a.jsx)(p.$,{size:"sm",variant:"default",onClick:()=>{v(e),y(""),j(!0)},children:"Respond"})]},e.id))]},s):null})})]}),(0,a.jsxs)(S,{children:[(0,a.jsxs)(C,{children:[(0,a.jsx)(k,{children:"Failed Schedules"}),(0,a.jsx)(E,{children:"Schedules that require manual confirmation"})]}),(0,a.jsxs)(F,{className:"space-y-4 max-h-[350px] overflow-y-auto pr-3",children:[x&&(0,a.jsx)("p",{children:"Loading schedules..."}),!x&&0===P.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No failed schedules to review."}),P.map(e=>{let s=h.isPending&&h.variables===e.id;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-500/10 rounded-lg flex items-center justify-center",children:(0,a.jsx)(tC.A,{className:"w-5 h-5 text-blue-500"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.reason||"Reason not specified"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,a.jsx)(m.A,{className:"w-3 h-3"}),e.room_name," â€¢ ",e.bed_name]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[(0,a.jsx)(tS.A,{className:"w-3 h-3"}),new Date(e.created_at).toLocaleString()]})]})]}),(0,a.jsx)(p.$,{size:"sm",variant:"secondary",onClick:()=>h.mutate(e.id),disabled:h.isPending,children:s?"Updating...":"Acknowledge"})]},e.id)})]})]})]}),(0,a.jsx)(eJ,{open:g,onOpenChange:j,children:(0,a.jsxs)(eZ,{className:"sm:max-w-md",children:[(0,a.jsx)(eX,{children:(0,a.jsx)(e4,{children:"Respond to Alert"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[f&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Room: ",f.room," â€¢ Bed: ",f.bed]}),(0,a.jsx)(ez.p,{placeholder:"Enter response reason...",value:N,onChange:e=>y(e.target.value)})]}),(0,a.jsxs)(e0,{className:"flex justify-end gap-2",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),(0,a.jsx)(p.$,{onClick:_,disabled:c.isPending||!N.trim(),children:c.isPending?"Updating...":"Submit"})]})]})})]})}function tE(e){let{user:s,onLogout:t}=e,[n,l]=(0,r.useState)(()=>{try{let e=window.location.hash;if(e.startsWith("#view="))return decodeURIComponent(e.replace("#view=",""));return localStorage.getItem("adminActiveView")||"overview"}catch(e){return"overview"}});(0,r.useEffect)(()=>{try{localStorage.setItem("adminActiveView",n),window.location.hash="view=".concat(encodeURIComponent(n))}catch(e){}},[n]);let{alertMessage:i,clearAlert:d}=(0,tx.M)(),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w,{user:s,onLogout:()=>{c(!0)},activeView:n,setActiveView:l}),(0,a.jsx)(tA,{isOpen:o,onOpenChange:e=>{c(e)},title:"Sign out",description:"Are you sure you want to sign out? You will be returned to the login screen.",isConfirming:m,onConfirm:()=>{u(!0);try{localStorage.removeItem("adminActiveView")}catch(e){}t()}}),(0,a.jsxs)(h.sF,{className:"flex flex-col h-screen overflow-hidden",children:[(0,a.jsxs)("header",{className:"sticky top-0 z-20 flex h-16 items-center gap-3 border-b bg-white px-4 shadow-sm",children:[(0,a.jsx)(h.x2,{}),(0,a.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground font-medium",children:(0,a.jsx)("span",{className:"text-lg text-muted-foreground",children:"Admin Dashboard"})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto ".concat(""),children:(()=>{switch(n){case"overview":default:return(0,a.jsx)(tk,{title:"Admin Overview"});case"robots":return(0,a.jsx)(eb,{});case"patients":return(0,a.jsx)(sE,{});case"nurses":return(0,a.jsx)(s$,{});case"management":return(0,a.jsx)(tu,{});case"map":return(0,a.jsx)(sY,{})}})()})]})]})}var tF=t(9803),tR=t(4653);let tL=[{id:"overview",title:"Overview",icon:i.A},{id:"robots",title:"Robot Status",icon:d.A},{id:"patients",title:"My Patients",icon:sF.A},{id:"management",title:"Management",icon:o.A},{id:"waypoints",title:"Waypoints",icon:m.A},{id:"videos",title:"Tutorials",icon:tF.A},{id:"apparatus",title:"Apparatus",icon:u.A},{id:"scheduler",title:"Scheduler",icon:tR.A},{id:"map",title:"Map Management",icon:m.A}];function tP(e){let{user:s,onLogout:t,activeView:r,setActiveView:n}=e;return(0,a.jsxs)(h.Bx,{children:[(0,a.jsx)(h.Gh,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between px-2 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-[#9d4ec3]/10 dark:bg-[#9d4ec3]/20 rounded-lg flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"w-4 h-4 text-[#9d4ec3]"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"font-semibold dark:text-white",children:"MedBot Nurse"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Welcome, ",s.name]})]})]}),(0,a.jsx)(y,{})]})}),(0,a.jsx)(h.Yv,{children:(0,a.jsx)(h.Cn,{children:(0,a.jsx)(h.rQ,{children:(0,a.jsx)(h.wZ,{children:tL.map(e=>(0,a.jsx)(h.FX,{children:(0,a.jsxs)(h.Uj,{onClick:()=>n(e.id),isActive:r===e.id,className:"w-full justify-start",children:[(0,a.jsx)(e.icon,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.title})]})},e.id))})})})}),(0,a.jsx)(h.CG,{children:(0,a.jsxs)(p.$,{variant:"ghost",onClick:t,className:"w-full justify-start text-muted-foreground hover:text-foreground",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]})}let tD=async()=>{let{data:e}=await H.A.get("bed/data/room/position/view/");return e},tI=async e=>{let{data:s}=await H.I.post("webhook/create-room-entry-position/",e);return s},tq=async e=>{let{data:s}=await H.I.post("webhook/create-room-exit-position/",e);return s};var tO=t(5742);function tM(){let{waypoints:e,isLoadingWaypoints:s,error:t,createEntry:n,createExit:l,isCreatingEntry:i,isCreatingExit:d}=function(){let e=(0,J.jE)(),s=(0,Q.I)({queryKey:["waypoints"],queryFn:tD,select:e=>e.data}),t=(0,W.n)({mutationFn:e=>tI(e),onSuccess:()=>{e.invalidateQueries({queryKey:["waypoints"]})}}),a=(0,W.n)({mutationFn:e=>tq(e),onSuccess:()=>{e.invalidateQueries({queryKey:["waypoints"]})}});return{waypoints:s.data,isLoadingWaypoints:s.isLoading,error:s.error,createEntry:t.mutateAsync,createExit:a.mutateAsync,isCreatingEntry:t.isPending,isCreatingExit:a.isPending}}(),[o,c]=(0,r.useState)(null),[u,x]=(0,r.useState)(null);return s?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen ",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}),"Loading waypoints..."]})}):t?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)(S,{className:"w-full max-w-md",children:(0,a.jsx)(F,{className:"pt-6",children:(0,a.jsx)("div",{className:"flex items-center gap-2 text-destructive",children:(0,a.jsxs)("span",{className:"text-sm",children:["Error loading waypoints:"," ",t.message]})})})})}):(0,a.jsxs)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Waypoints"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Waypoints guide the robot through exact positions to complete its path."})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-6",children:null==e?void 0:e.map(e=>{var s,t,r,n,l,i;return(0,a.jsxs)(S,{className:"relative  ",children:[(0,a.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,a.jsx)(I,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})}),(0,a.jsxs)(C,{className:"pb-3",children:[(0,a.jsx)(k,{className:"text-lg pr-16",children:e.room_name}),(0,a.jsxs)(E,{children:["Created"," ",new Date(e.created_at).toLocaleDateString()]})]}),(0,a.jsxs)(F,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mt-0.5 text-green-600"}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-green-700",children:"Entry Point"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[(0,a.jsxs)("div",{children:["X: ",null!==(s=null==e?void 0:e.entry_point.x)&&void 0!==s?s:0]}),(0,a.jsxs)("div",{children:["Y: ",null!==(t=null==e?void 0:e.entry_point.y)&&void 0!==t?t:0]}),(0,a.jsxs)("div",{children:["Yaw: ",null!==(r=null==e?void 0:e.entry_point.yaw)&&void 0!==r?r:0,"\xb0"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-muted/50 rounded-lg",children:[(0,a.jsx)(tO.A,{className:"h-4 w-4 mt-0.5 text-orange-600"}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-orange-700",children:"Exit Point"}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[(0,a.jsxs)("div",{children:["X: ",null!==(n=null==e?void 0:e.exit_point.x)&&void 0!==n?n:0]}),(0,a.jsxs)("div",{children:["Y: ",null!==(l=null==e?void 0:e.exit_point.y)&&void 0!==l?l:0]}),(0,a.jsxs)("div",{children:["Yaw: ",null!==(i=null==e?void 0:e.exit_point.yaw)&&void 0!==i?i:0,"\xb0"]})]})]})]})]})]},e.id)})})]})}var tT=t(2318),tU=t(2657);function t$(){let e=(0,J.jE)(),s=(0,Q.I)({queryKey:["schedulers"],queryFn:eI}),t=(0,W.n)({mutationFn:e=>eq(e),onSuccess:()=>{e.invalidateQueries({queryKey:["schedulers"]})}});return{schedulers:s.data,isLoadingSchedulers:s.isLoading,error:s.error,addOrUpdate:t.mutate,isMutating:t.isPending}}function tK(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>eO(e),onSuccess:s=>{Y.oR.success(s.message||"Scheduler Excel uploaded successfully!"),e.invalidateQueries({queryKey:["schedulers"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to upload Excel.")}})}function tz(){return(0,W.n)({mutationFn:()=>eM(),onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to download Excel.")},onSuccess:e=>{let s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="scheduler_data.xlsx",t.addEventListener("click",()=>{Y.oR.success("Download started!")}),document.body.appendChild(t),t.click(),t.remove(),URL.revokeObjectURL(s)}})}var tB=t(6981);let tV=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(tB.bL,{ref:s,className:(0,v.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,a.jsx)(tB.C1,{className:(0,v.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(e5.A,{className:"h-4 w-4"})})})});tV.displayName=tB.bL.displayName;var tQ=t(3332);let tJ=[{key:"monday",label:"Monday",short:"Mon"},{key:"tuesday",label:"Tuesday",short:"Tue"},{key:"wednesday",label:"Wednesday",short:"Wed"},{key:"thursday",label:"Thursday",short:"Thu"},{key:"friday",label:"Friday",short:"Fri"},{key:"saturday",label:"Saturday",short:"Sat"},{key:"sunday",label:"Sunday",short:"Sun"}],tW=[{value:"morning",label:"Morning"},{value:"afternoon",label:"Afternoon"},{value:"evening",label:"Evening"},{value:"night",label:"Night"}];function tY(e){let{isOpen:s,onOpenChange:t,scheduler:n,onSubmit:l,isMutating:i}=e,{register:d,handleSubmit:o,reset:c,control:m,formState:{errors:u}}=(0,sH.mN)(),x=!!n;return(0,r.useEffect)(()=>{s&&(x&&n?c({batch_name:n.batch_name,time_slot:n.time_slot,trigger_time:n.trigger_time.slice(0,5),...tJ.reduce((e,s)=>({...e,[s.key]:n[s.key]}),{})}):c({batch_name:"",time_slot:"morning",trigger_time:"",...tJ.reduce((e,s)=>({...e,[s.key]:!1}),{})}))},[s,x,n,c]),(0,a.jsx)(eJ,{open:s,onOpenChange:t,children:(0,a.jsxs)(eZ,{className:"sm:max-w-[520px] max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(eX,{className:"space-y-3",children:[(0,a.jsxs)(e4,{className:"flex items-center gap-2 text-xl",children:[(0,a.jsx)(sn.A,{className:"h-5 w-5 text-primary"}),x?"Edit Scheduler":"Create New Scheduler"]}),(0,a.jsx)(e2,{className:"text-sm text-muted-foreground",children:x?"Update the details for this schedule.":"Configure your batch schedule settings below."})]}),(0,a.jsxs)("form",{onSubmit:o(e=>{let s={...e};x&&n&&(s.pk=n.id),l(s)}),className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(eB.J,{htmlFor:"batch_name",className:"flex items-center gap-2 text-sm font-medium",children:[(0,a.jsx)(tQ.A,{className:"h-4 w-4"}),"Batch Name"]}),(0,a.jsx)(ez.p,{id:"batch_name",placeholder:"Enter batch name...",...d("batch_name",{required:"Batch name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),className:u.batch_name?"border-red-500":""}),u.batch_name&&(0,a.jsx)("p",{className:"text-xs text-red-600",children:u.batch_name.message})]}),(0,a.jsxs)("div",{className:"space-y-4 p-4 bg-muted/30 rounded-lg",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(tS.A,{className:"h-4 w-4"}),"Time Configuration"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eB.J,{htmlFor:"time_slot",className:"text-sm",children:"Time Slot"}),(0,a.jsx)(sH.xI,{name:"time_slot",control:m,rules:{required:"Time slot is required"},render:e=>{let{field:s}=e;return(0,a.jsxs)(e6,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(e9,{className:u.time_slot?"border-red-500":"",children:(0,a.jsx)(e8,{placeholder:"Select time slot"})}),(0,a.jsx)(ss,{children:tW.map(e=>(0,a.jsx)(st,{value:e.value,children:e.label},e.value))})]})}}),u.time_slot&&(0,a.jsx)("p",{className:"text-xs text-red-600",children:u.time_slot.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eB.J,{htmlFor:"trigger_time",className:"text-sm",children:"Trigger Time"}),(0,a.jsx)(ez.p,{id:"trigger_time",type:"time",...d("trigger_time",{required:"Trigger time is required"}),className:u.trigger_time?"border-red-500":""}),u.trigger_time&&(0,a.jsx)("p",{className:"text-xs text-red-600",children:u.trigger_time.message})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(eB.J,{className:"text-sm font-medium",children:"Schedule Days"}),(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-card",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3",children:tJ.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 rounded-md hover:bg-muted/50 transition-colors",children:[(0,a.jsx)(sH.xI,{name:e.key,control:m,render:s=>{let{field:t}=s;return(0,a.jsx)(tV,{id:e.key,checked:!!t.value,onCheckedChange:t.onChange,className:"data-[state=checked]:bg-primary data-[state=checked]:border-primary"})}}),(0,a.jsxs)("label",{htmlFor:e.key,className:"text-sm font-medium cursor-pointer select-none flex-1",children:[(0,a.jsx)("span",{className:"hidden sm:inline",children:e.label}),(0,a.jsx)("span",{className:"sm:hidden",children:e.short})]})]},e.key))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-3 text-center",children:"Select the days when this schedule should be active"})]})]}),(0,a.jsxs)(e0,{className:"pt-6 gap-2",children:[(0,a.jsx)(p.$,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:i,children:"Cancel"}),(0,a.jsxs)(p.$,{type:"submit",disabled:i,className:"min-w-[140px]",children:[i&&(0,a.jsx)(sa.A,{className:"mr-2 h-4 w-4 animate-spin"}),x?"Save Changes":"Create Schedule"]})]})]})]})})}function tH(e){let{isOpen:s,onOpenChange:t}=e,{data:n,isLoading:l}=(0,Q.I)({queryKey:["active-patients"],queryFn:()=>ek()}),{schedulers:i}=t$(),d=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>{let{patientId:s,batchId:t}=e;return eF(s,t)},onSuccess:s=>{Y.oR.success(s.message||"Patient assigned to batch successfully!"),e.invalidateQueries({queryKey:["patients"]}),e.invalidateQueries({queryKey:["schedulers"]}),e.invalidateQueries({queryKey:["slots"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to assign patient to batch.")}})}(),o=((0,J.jE)(),(0,W.n)({mutationFn:e=>{let{patientId:s,batchId:t}=e;return eR(s,t)},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to check schedule.")}})),[c,m]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),[h,g]=(0,r.useState)(null),j=(0,r.useMemo)(()=>{var e;return(null==n?void 0:null===(e=n.data)||void 0===e?void 0:e.filter(e=>e.is_active))||[]},[n]),f=()=>{m(null),x(null),g(null)},v=()=>{f(),t(!1)},N=async()=>{if(!c||!u)return Y.oR.error("Please select both patient and batch");try{let e=await o.mutateAsync({patientId:c,batchId:u});if((null==e?void 0:e.status)==="warning"){g({message:e.message,data:e.data});return}await d.mutateAsync({patientId:c,batchId:u}),f(),t(!1)}catch(t){var e,s;Y.oR.error((null==t?void 0:null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||(null==t?void 0:t.message)||"Something went wrong")}},y=async()=>{if(c&&u)try{await d.mutateAsync({patientId:c,batchId:u}),f(),t(!1)}catch(t){var e,s;Y.oR.error((null==t?void 0:null===(s=t.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||(null==t?void 0:t.message)||"Failed to assign patient.")}};return(0,a.jsx)(eJ,{open:s,onOpenChange:v,children:(0,a.jsxs)(eZ,{className:"sm:max-w-md",children:[(0,a.jsx)(eX,{children:(0,a.jsx)(e4,{children:"Assign Patient to Batch"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Select Batch"}),(0,a.jsxs)(e6,{onValueChange:e=>x(Number(e)),value:(null==u?void 0:u.toString())||"",children:[(0,a.jsx)(e9,{children:(0,a.jsx)(e8,{placeholder:"Select Batch"})}),(0,a.jsx)(ss,{children:null==i?void 0:i.filter(e=>!e.is_stopped).map(e=>(0,a.jsxs)(st,{value:String(e.id),children:[e.batch_name," (",e.time_slot,")"]},e.id))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Select Patient"}),(0,a.jsxs)(e6,{onValueChange:e=>m(Number(e)),value:(null==c?void 0:c.toString())||"",children:[(0,a.jsx)(e9,{children:(0,a.jsx)(e8,{placeholder:l?"Loading patients...":"Select Patient"})}),(0,a.jsx)(ss,{children:j.length>0?j.map(e=>(0,a.jsxs)(st,{value:String(e.id),children:[e.name," (",e.patient_id,")"]},e.id)):(0,a.jsx)("div",{className:"p-2 text-center text-sm text-gray-500",children:"No active patients found"})})]})]}),h&&(0,a.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:[(0,a.jsx)("p",{className:"text-sm",children:h.message}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end mt-3",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:()=>g(null),disabled:d.isLoading||o.isLoading,children:"No"}),(0,a.jsx)(p.$,{onClick:y,disabled:d.isLoading||o.isLoading,children:d.isLoading?"Assigning...":"Yes, switch"})]})]})]}),(0,a.jsxs)(e0,{className:"flex gap-2",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:v,disabled:d.isLoading||o.isLoading,children:"Cancel"}),(0,a.jsx)(p.$,{onClick:N,disabled:!c||!u||d.isLoading||o.isLoading,className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:(o.isLoading||d.isLoading)&&!h?"Processing...":"Assign Patient"})]})]})})}var tG=t(5143),tZ=t(402),tX=t(8266),t0=t(8021);function t4(e){let{slot:s,index:t,isOverlay:r=!1,onDelete:n,isDeleting:l}=e;return(0,a.jsxs)("div",{className:"".concat("flex items-center justify-between w-full text-left p-3 rounded-lg shadow-sm border"," ").concat(r?"ring-2 ring-blue-500 bg-white shadow-lg":"bg-slate-50 hover:bg-slate-100"," ").concat(r?"":"cursor-grab"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"text-sm font-bold text-slate-500 w-6 text-center",children:[t+1,"."]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-slate-800",children:[s.patient.name," (",s.patient.patient_id,")"]}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:s.bed_name})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[n&&(0,a.jsx)("button",{type:"button",onClick:()=>n(s.id),disabled:l,onPointerDown:e=>e.stopPropagation(),className:"p-1.5 rounded-md text-slate-400 hover:bg-red-100 hover:text-red-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Remove patient",children:l?(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(eQ.A,{className:"h-4 w-4"})}),(0,a.jsx)(t0.A,{className:"h-5 w-5 text-slate-400"})]})]})}function t2(e){let{slot:s,index:t,onDelete:r,isDeleting:n}=e,{attributes:l,listeners:i,setNodeRef:d,transform:o,transition:c,isDragging:m}=(0,tZ.gl)({id:"slot-".concat(s.id),data:{type:"patient",slot:s}}),u={transform:tX.Ks.Transform.toString(o),transition:c,opacity:m?.5:1};return(0,a.jsx)("li",{ref:d,style:u,...l,...i,children:(0,a.jsx)(t4,{slot:s,index:t,onDelete:r,isDeleting:n})})}function t1(e){let{room:s,children:t}=e,{attributes:r,listeners:n,setNodeRef:l,transform:i,transition:d,isDragging:o}=(0,tZ.gl)({id:"room-".concat(s.room),data:{type:"room",schedule_order:s.schedule_order}}),c={transform:tX.Ks.Transform.toString(i),transition:d,opacity:o?.8:1,zIndex:o?10:"auto"};return(0,a.jsxs)("div",{ref:l,style:c,className:"space-y-3 bg-white p-4 rounded-lg border shadow-sm",children:[(0,a.jsxs)("div",{...r,...n,className:"pb-2 border-b border-slate-200 cursor-grab flex items-center gap-2 touch-none",children:[(0,a.jsx)(t0.A,{className:"h-5 w-5 text-slate-400"}),(0,a.jsxs)("h3",{className:"text-sm font-semibold text-slate-600",children:["Room ",s.room]})]}),t]})}function t3(e){let{isOpen:s,onOpenChange:t,batchId:n}=e,{data:l,isLoading:i}=(0,Q.I)({queryKey:["slots"],queryFn:eC}),{mutate:d}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>{let{pk1:s,pk2:t}=e;return eT({pk1:s,pk2:t})},onSuccess:s=>{Y.oR.success(s.message||"Patients swapped successfully!"),e.invalidateQueries({queryKey:["slots"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to swap patients.")}})}(),{mutate:o,isPending:c}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>eL(e),onSuccess:s=>{Y.oR.success(s.message||"Patient removed from batch successfully!"),e.invalidateQueries({queryKey:["slots"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to remove patient.")}})}(),{mutate:m}=function(){let e=(0,J.jE)();return(0,W.n)({mutationFn:e=>eU(e),onSuccess:s=>{Y.oR.success((null==s?void 0:s.message)||"Rooms swapped successfully"),e.invalidateQueries({queryKey:["slots"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to swap rooms")}})}(),[u,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),g=(0,r.useMemo)(()=>l&&n?l.map(e=>{let s=e.slots.filter(e=>e.batch.id===n);return 0===s.length?null:{room:e.row_number,schedule_order:s[0].schedule_order,slots:s}}).filter(e=>null!==e).sort((e,s)=>e.schedule_order-s.schedule_order):[],[l,n]),[j,f]=(0,r.useState)(null),[v,N]=(0,r.useState)([]);(0,r.useEffect)(()=>{N(g)},[g]);let y=(0,tG.FR)((0,tG.MS)(tG.AN,{activationConstraint:{distance:8}})),b=(0,r.useMemo)(()=>{if("string"!=typeof j||!j.startsWith("slot-"))return;let e=parseInt(j.replace("slot-",""),10);return v.flatMap(e=>e.slots).find(s=>s.id===e)},[j,v]),w=e=>{p(e),x(!0)},A={duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)",sideEffects:(0,tG.WB)({styles:{active:{opacity:"0.4"}}})};return s&&null!==n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eJ,{open:s,onOpenChange:t,children:(0,a.jsx)(eZ,{className:"mx-4",style:{height:"85vh",maxHeight:"85vh",display:"flex",flexDirection:"column",padding:0,overflow:"hidden"},children:(0,a.jsxs)(tG.Mp,{sensors:y,collisionDetection:tG.fp,onDragStart:function(e){let{active:s}=e;f(s.id)},onDragEnd:function(e){var s,t,a,r;let{active:l,over:i}=e;if(!i||l.id===i.id){f(null);return}let o=null===(s=l.data.current)||void 0===s?void 0:s.type,c=null===(t=i.data.current)||void 0===t?void 0:t.type;if("room"===o&&"room"===c){let e=null===(a=l.data.current)||void 0===a?void 0:a.schedule_order,s=null===(r=i.data.current)||void 0===r?void 0:r.schedule_order;if(void 0===e||void 0===s)return;N(t=>{let a=t.findIndex(e=>"room-".concat(e.room)===l.id),r=t.findIndex(e=>"room-".concat(e.room)===i.id);if(-1!==a&&-1!==r){let l=(0,tZ.be)(t,a,r);return n?m({room_pos_a:e,room_pos_b:s,batch_id:n}):(console.error("Cannot swap rooms, batchId is missing."),Y.oR.error("An error occurred: Batch ID is missing.")),l}return t})}if("patient"===o&&"patient"===c){let e=parseInt(String(l.id).replace("slot-","")),s=parseInt(String(i.id).replace("slot-",""));N(t=>t.map(t=>{let a=t.slots.findIndex(s=>s.id===e),r=t.slots.findIndex(e=>e.id===s);if(-1!==a&&-1!==r){let n=(0,tZ.be)(t.slots,a,r);return d({pk1:e,pk2:s}),{...t,slots:n}}return t}))}f(null)},onDragCancel:function(){f(null)},children:[(0,a.jsx)("div",{className:"p-6 pb-4 border-b border-slate-200 flex-shrink-0",children:(0,a.jsxs)(eX,{children:[(0,a.jsx)(e4,{children:"Arrange Patient Rounds"}),(0,a.jsx)(e2,{children:"Drag a room header to reorder rooms. Drag a patient to reorder within a room."})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto relative bg-slate-50",style:{minHeight:0,overflowY:"auto",overflowX:"hidden"},children:i?(0,a.jsx)("div",{className:"flex items-center justify-center h-full ",children:"Loading..."}):0===v.length?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:"No patients assigned to this batch."}):(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(tZ.gB,{items:v.map(e=>"room-".concat(e.room)),strategy:tZ._G,children:v.map(e=>(0,a.jsx)(t1,{room:e,children:(0,a.jsx)(tZ.gB,{items:e.slots.map(e=>"slot-".concat(e.id)),strategy:tZ._G,children:(0,a.jsx)("ul",{className:"space-y-2",children:e.slots.map((e,s)=>(0,a.jsx)(t2,{slot:e,index:s,onDelete:w,isDeleting:c&&h===e.id},e.id))})})},e.room))})})})}),(0,a.jsx)(tG.Hd,{dropAnimation:A,children:b?(0,a.jsx)(t4,{slot:b,index:0,isOverlay:!0}):null})]})})}),(0,a.jsx)(tA,{isOpen:u,onOpenChange:x,onConfirm:()=>{h&&o(h,{onSuccess:()=>{x(!1),p(null)},onError:()=>{x(!1),p(null)}})},isConfirming:c,title:"Are you sure?",description:"This will permanently remove the patient from this batch. This action cannot be undone."})]}):null}function t5(){let{schedulers:e,isLoadingSchedulers:s,error:t,addOrUpdate:n,isMutating:l}=t$(),[i,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),[x,h]=(0,r.useState)(null),[g,j]=(0,r.useState)(!1),f=e=>{u(e||null),d(!0)},v=e=>{n({pk:e.id,is_stopped:!e.is_stopped})},N=e=>{h(e),j(!0)};return s?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen ",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}),"Loading schedules..."]})}):t?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen ",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:["Failed to load schedulers: ",t.message]})}):(0,a.jsx)("div",{className:"flex flex-col h-full mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:(0,a.jsxs)("div",{className:"h-full p-2 md:p-2 flex flex-col gap-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center  ",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold ",children:"Batch Schedulers"}),(0,a.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,a.jsxs)(p.$,{onClick:()=>c(!0),variant:"outline",className:"border-purple-500 text-purple-600 hover:bg-purple-50 hover:text-purple-700 transition-colors",children:[(0,a.jsx)(tT.A,{className:"mr-2 h-4 w-4"})," Assign Patient"]}),(0,a.jsxs)(p.$,{onClick:()=>f(),className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:[(0,a.jsx)(tn.A,{className:"mr-2 h-4 w-4"})," Add Schedule"]}),(0,a.jsx)(s_,{uploadHook:tK,downloadHook:tz,buttonLabel:"Manage Excel"})]})]}),e&&0!==e.length?(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,a.jsxs)(S,{className:"hover:shadow-lg transition-shadow duration-300 rounded-xl overflow-hidden flex flex-col justify-between",children:[(0,a.jsx)(C,{className:"bg-purple-50 p-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(k,{className:"text-xl font-semibold text-purple-800",children:e.batch_name}),(0,a.jsx)("span",{className:"text-sm font-medium px-3 py-1 rounded-full ".concat(e.is_stopped?"bg-red-100 text-red-700":"bg-green-100 text-green-700"),children:e.is_stopped?"Stopped":"Active"})]})}),(0,a.jsxs)(F,{className:"p-4  space-y-3 flex-grow",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-700",children:[(0,a.jsxs)("p",{className:"",children:[(0,a.jsx)("strong",{className:"font-medium ",children:"Time Slot:"})," ",e.time_slot]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{className:"font-medium",children:"Trigger Time:"})," ",e.trigger_time]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap ",children:[(0,a.jsx)("strong",{className:"text-sm font-medium ",children:"Days:"}),["monday","tuesday","wednesday","thursday","friday","saturday","sunday"].filter(s=>e[s]).map(e=>(0,a.jsx)("span",{className:"px-2 py-1 bg-gray-100 dark:bg-black rounded-lg text-xs font-semibold ",children:e.slice(0,3).toUpperCase()},e))]}),(0,a.jsxs)("p",{className:"text-sm flex items-center gap-1",children:[(0,a.jsx)("strong",{className:"font-medium ",children:"Notified:"}),(0,a.jsx)("span",{className:e.is_notified?"text-green-600":"text-red-600",children:e.is_notified?"Yes":"No"})]}),(0,a.jsxs)("p",{className:"text-xs  pt-2 border-t mt-4",children:["Created At:"," ",new Date(e.created_at).toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs  pt-2 border-t mt-4",children:["Completed at:"," ",e.completed_time?new Date(e.completed_time).toLocaleString("en-IN",{dateStyle:"medium",timeStyle:"short"}):"Not completed yet"]})]}),(0,a.jsxs)(R,{className:"p-4 bg-gray-50 border-t flex justify-between items-center",children:[(0,a.jsxs)(p.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1 text-purple-600 hover:text-purple-800 transition-colors",onClick:()=>N(e.id),children:[(0,a.jsx)(tU.A,{className:"h-4 w-4"})," View Patients"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(p.$,{variant:"outline",size:"icon",onClick:()=>f(e),"aria-label":"Edit Schedule",className:"text-gray-600 hover:bg-gray-200",children:(0,a.jsx)(sl.A,{className:"h-4 w-4"})}),(0,a.jsx)(p.$,{variant:"outline",size:"icon",onClick:()=>v(e),disabled:l,"aria-label":e.is_stopped?"Activate Schedule":"Deactivate Schedule",className:"\n                        ".concat(e.is_stopped?"text-green-600 hover:text-green-700":"text-red-600 hover:bg-red-50 hover:text-red-700","\n                      "),children:e.is_stopped?(0,a.jsx)(T.A,{className:"h-4 w-4"}):(0,a.jsx)(sd.A,{className:"h-4 w-4"})})]})]})]},e.id))}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No schedules available."}),(0,a.jsx)(t3,{isOpen:g,onOpenChange:j,batchId:x}),(0,a.jsx)(tY,{isOpen:i,onOpenChange:d,scheduler:m,onSubmit:e=>{n(e,{onSuccess:()=>{d(!1)}})},isMutating:l}),(0,a.jsx)(tH,{isOpen:o,onOpenChange:c})]})})}let t6=async()=>{let{data:e}=await H.A.get("video_management/view-all-video/");return e},t8=async e=>{let{data:s}=await H.A.post("video_management/add-video/",e);return s},t9=async(e,s)=>{let t=new FormData;t.append("pk1",String(e)),t.append("pk2",String(s));let{data:a}=await H.A.post("video_management/swap-video/",t);return a},t7=async e=>{let{data:s}=await H.A.delete("video_management/delete-video/",{data:{pk:e}});return s};function ae(){let e=(0,J.jE)(),s=(0,Q.I)({queryKey:["videos"],queryFn:t6,select:e=>e.data}),t=(0,W.n)({mutationFn:e=>t8(e),onSuccess:()=>e.invalidateQueries({queryKey:["videos"]})}),a=(0,W.n)({mutationFn:e=>{let{pk1:s,pk2:t}=e;return t9(s,t)},onSuccess:()=>e.invalidateQueries({queryKey:["videos"]})}),r=(0,W.n)({mutationFn:e=>t7(e),onSuccess:()=>e.invalidateQueries({queryKey:["videos"]})});return{videos:s.data,isLoadingVideos:s.isPending,errorVideos:s.error,refetchVideos:s.refetch,createVideo:t.mutateAsync,isCreatingVideo:t.isPending,swapVideos:a.mutateAsync,isSwapping:a.isPending,deleteVideo:r.mutateAsync,isDeleting:r.isPending}}function as(){let{createVideo:e,isCreatingVideo:s}=ae(),[t,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)(""),[d,o]=(0,r.useState)(!0),c=(0,r.useRef)(null),m=async s=>{var t,a;if(s.preventDefault(),!(null===(a=c.current)||void 0===a?void 0:null===(t=a.files)||void 0===t?void 0:t[0]))return;let r=new FormData;r.append("video_name",l),r.append("video_image_file",c.current.files[0]),r.append("is_active",String(d));let m=Y.oR.loading("Uploading...");try{await e(r),Y.oR.success("Uploaded successfully!",{id:m}),n(!1),i(""),o(!0),c.current&&(c.current.value="")}catch(e){console.error("Failed to create video:",e),Y.oR.error("Failed to upload. Try again.",{id:m})}};return(0,a.jsxs)(eJ,{open:t,onOpenChange:n,children:[(0,a.jsx)(eW,{asChild:!0,children:(0,a.jsx)(p.$,{className:"bg-[#9d4ec3] hover:bg-[#8a42b8]",children:"+ Add Video"})}),(0,a.jsxs)(eZ,{children:[(0,a.jsx)(eX,{children:(0,a.jsx)(e4,{children:"Add New Video"})}),(0,a.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eB.J,{htmlFor:"video_name",children:"Video/Image Name"}),(0,a.jsx)(ez.p,{id:"video_name",value:l,onChange:e=>i(e.target.value),required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(eB.J,{htmlFor:"video_image_file",children:"Video or Image File"}),(0,a.jsx)(ez.p,{id:"video_image_file",type:"file",accept:"video/*,image/*",ref:c,required:!0})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(tV,{id:"is_active",checked:d,onCheckedChange:e=>o(!!e)}),(0,a.jsx)(eB.J,{htmlFor:"is_active",children:"Active"})]}),(0,a.jsx)(e0,{children:(0,a.jsx)(p.$,{type:"submit",disabled:s,children:s?"Uploading...":"Save"})})]})]})]})}var at=t(3096);function aa(e){let{fileUrl:s,isVideo:t,title:r}=e,{ref:n,inView:l}=(0,at.Wx)({triggerOnce:!0,threshold:.2});return(0,a.jsx)(A.P.div,{ref:n,initial:{opacity:0,y:30},animate:l?{opacity:1,y:0}:{},transition:{duration:.4},className:"aspect-video bg-gray-100 rounded-lg flex items-center justify-center",children:l?t?(0,a.jsx)("video",{src:s,preload:"metadata",controls:!0,className:"w-full h-full object-cover"}):(0,a.jsx)("img",{src:s,alt:r,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-sm",children:"Loading..."})})}function ar(e){let{video:s,onToggle:t}=e,{attributes:r,listeners:n,setNodeRef:l,transform:i,transition:d}=(0,tZ.gl)({id:s.id}),o={transform:tX.Ks.Transform.toString(i),transition:d},c=s.video_url||s.video_image_file,m=(null==c?void 0:c.endsWith(".mp4"))||(null==c?void 0:c.endsWith(".webm"))||(null==c?void 0:c.endsWith(".mov"));return(0,a.jsx)("div",{ref:l,style:o,children:(0,a.jsxs)(S,{className:"group hover:shadow-lg transition relative",children:[(0,a.jsxs)(C,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(k,{className:"group-hover:text-[#9d4ec3] transition",children:s.video_name}),(0,a.jsx)("span",{...n,...r,className:"cursor-grab p-2 rounded-full hover:bg-gray-200",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-grip-vertical",children:[(0,a.jsx)("circle",{cx:"9",cy:"20",r:"1"}),(0,a.jsx)("circle",{cx:"9",cy:"14",r:"1"}),(0,a.jsx)("circle",{cx:"9",cy:"8",r:"1"}),(0,a.jsx)("circle",{cx:"9",cy:"2",r:"1"}),(0,a.jsx)("circle",{cx:"15",cy:"20",r:"1"}),(0,a.jsx)("circle",{cx:"15",cy:"14",r:"1"}),(0,a.jsx)("circle",{cx:"15",cy:"8",r:"1"}),(0,a.jsx)("circle",{cx:"15",cy:"2",r:"1"})]})})]}),(0,a.jsxs)(E,{children:["Uploaded on ",new Date(s.created_at).toLocaleDateString()]})]}),(0,a.jsxs)(F,{children:[c?(0,a.jsx)(aa,{fileUrl:c,isVideo:m,title:s.video_name}):(0,a.jsx)("span",{children:"No File"}),(0,a.jsx)(p.$,{variant:s.is_active?"destructive":"default",size:"sm",className:"mt-4",onClick:()=>t(s.id),children:s.is_active?"Deactivate":"Activate"})]})]})})}function an(){var e;let{videos:s,isLoadingVideos:t,swapVideos:n,createVideo:l,deleteVideo:i}=ae(),[d,o]=(0,r.useState)(null!==(e=null==s?void 0:s.map(e=>e.id))&&void 0!==e?e:[]);(0,r.useRef)(null),(0,r.useEffect)(()=>{s&&o(s.map(e=>e.id))},[s]);let c=(0,tG.FR)((0,tG.MS)(tG.AN)),m=async e=>{let{active:s,over:t}=e;if(t&&s.id!==t.id){let e=d.indexOf(s.id),a=d.indexOf(t.id);o((0,tZ.be)(d,e,a));try{await n({pk1:s.id,pk2:t.id})}catch(e){console.error("Swap failed:",e)}}},u=async e=>{try{await i(e)}catch(e){console.error("Toggle failed:",e)}};if(t)return(0,a.jsx)("div",{className:"flex items-center justify-center h-screen ",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}),"Loading training sections..."]})});function x(){return(0,a.jsxs)("div",{className:"space-y-2 animate-pulse",children:[(0,a.jsx)("div",{className:"bg-gray-200 rounded-lg aspect-video"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})}return(0,a.jsxs)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Training Videos"}),(0,a.jsx)(as,{})]}),t&&(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-3 lg:grid-cols-3",children:Array.from({length:3}).map((e,s)=>(0,a.jsx)(x,{},s))}),!t&&!(null==s?void 0:s.length)&&(0,a.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"No Videos Found"}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"Upload a video to get started."})]}),!t&&s&&s.length>0&&(0,a.jsx)(tG.Mp,{sensors:c,collisionDetection:tG.fp,onDragEnd:m,children:(0,a.jsx)(tZ.gB,{items:d,strategy:tZ._G,children:(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:s.map(e=>(0,a.jsx)(ar,{video:e,onToggle:u},e.id))})})})]})}let al=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,{data:t}=await H.A.get("vitals_management/bp2checkme/all/?page=".concat(e,"&page_size=").concat(s));return t},ai=async e=>{let{data:s}=await H.A.patch("vitals_management/bp2checkme/toggle-active/",{pk:e});return s},ad=async(e,s)=>{let{data:t}=await H.A.post("vitals_management/bp2checkme/upsert/",{id:e,...s});return t};var ao=t(7777);function ac(){let{apparatus:e,isLoadingApparatus:s,hasNextPage:t,fetchNextPage:n,isFetchingNextPage:l,toggleApparatus:i,editApparatus:d}=function(){var e,s;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,a=(0,J.jE)(),r=(0,ew.q)({queryKey:["apparatus",t],queryFn:e=>{let{pageParam:s=1}=e;return al(s,t)},initialPageParam:1,getNextPageParam:e=>{if(e.next)try{return Number(new URL(e.next).searchParams.get("page"))}catch(e){return}}}),n=(0,W.n)({mutationFn:ai,onSuccess:e=>{Y.oR.success(e.message||"Apparatus status updated successfully!"),a.invalidateQueries({queryKey:["apparatus"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to update apparatus status.")}}),l=(0,W.n)({mutationFn:e=>{let{id:s,updates:t}=e;return ad(s,t)},onSuccess:e=>{Y.oR.success(e.message||"Apparatus updated successfully!"),a.invalidateQueries({queryKey:["apparatus"]})},onError:e=>{var s,t;Y.oR.error((null==e?void 0:null===(t=e.response)||void 0===t?void 0:null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to update apparatus.")}});return{data:r.data,apparatus:null!==(s=null===(e=r.data)||void 0===e?void 0:e.pages.flatMap(e=>e.results.data).filter(Boolean))&&void 0!==s?s:[],isLoadingApparatus:r.isLoading,hasNextPage:r.hasNextPage,fetchNextPage:r.fetchNextPage,isFetchingNextPage:r.isFetchingNextPage,error:r.error,toggleApparatus:n.mutateAsync,editApparatus:l.mutateAsync}}(),[o,c]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),x=(0,r.useRef)(null),h=(0,r.useRef)(null),g=(0,r.useCallback)(e=>{let[s]=e;s.isIntersecting&&t&&!l&&n()},[t,l,n]);return((0,r.useEffect)(()=>{let e=x.current;if(e)return h.current&&h.current.disconnect(),h.current=new IntersectionObserver(g,{root:null,rootMargin:"100px",threshold:.1}),h.current.observe(e),()=>{h.current&&h.current.disconnect()}},[g]),s)?(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"h-4 w-4 animate-spin"}),"Loading apparatus..."]})}):(0,a.jsxs)("div",{className:"mx-auto space-y-6 px-4 md:px-6 lg:px-10 py-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Apparatus Dashboard"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage and view all medical apparatus. Click on a card to edit details or the image to enlarge."})]})}),(0,a.jsx)("div",{className:"grid w-full gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:null==e?void 0:e.map(e=>{var s;return(0,a.jsxs)(S,{className:"relative overflow-hidden rounded-xl",children:[(0,a.jsx)(C,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(k,{className:"text-lg font-bold",children:["#",e.id]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(I,{className:"text-xs px-3 py-1 font-semibold ".concat(e.is_active?"bg-green-500 text-white hover:bg-green-600":"bg-red-500 text-white hover:bg-red-600"),children:e.is_active?"Active":"Inactive"}),(0,a.jsx)(p.$,{size:"sm",variant:"outline",onClick:()=>c({...e}),children:(0,a.jsx)(sl.A,{className:"h-4 w-4"})})]})]})}),(0,a.jsxs)(F,{className:"flex gap-4 items-center",children:[(0,a.jsx)("div",{className:"w-32 h-32 flex-shrink-0 cursor-pointer rounded-md overflow-hidden border border-gray-200 transition-transform hover:scale-105",onClick:()=>{e.image_url&&u(e.image_url)},children:e.image_url?(0,a.jsx)("img",{src:e.image_url,alt:"Apparatus",className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"bg-gray-100 w-full h-full flex items-center justify-center text-xs text-gray-400",children:"No Image"})}),(0,a.jsxs)("div",{className:"flex-grow space-y-2",children:[(0,a.jsx)(ao.Bc,{children:(0,a.jsxs)(ao.m_,{children:[(0,a.jsx)(ao.k$,{asChild:!0,children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground truncate",children:["Patient:"," ",(0,a.jsx)("span",{className:"font-semibold text-gray-800",children:e.patient_name})]})}),(0,a.jsx)(ao.ZI,{children:(0,a.jsx)("p",{children:e.patient_name})})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-bold text-gray-700",children:"Sys:"}),(0,a.jsx)("span",{className:"text-gray-600",children:e.sys})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-bold text-gray-700",children:"Dia:"}),(0,a.jsx)("span",{className:"text-gray-600",children:null!==(s=e.dia)&&void 0!==s?s:"-"})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-bold text-gray-700",children:"MAP:"}),(0,a.jsx)("span",{className:"text-gray-600",children:e.map})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-bold text-gray-700",children:"Pulse:"}),(0,a.jsx)("span",{className:"text-gray-600",children:e.pulse_rate_note})]})]})]})]}),(0,a.jsx)(R,{className:"pt-4 flex justify-between items-center",children:(0,a.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Last updated: ",new Date(e.updated_at).toLocaleDateString()]})})]},e.id)})}),t&&(0,a.jsx)("div",{ref:x,className:"flex justify-center items-center py-8",children:l?(0,a.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(sa.A,{className:"w-4 h-4 animate-spin"}),"Loading more apparatus..."]}):(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Scroll down to load more apparatus"})}),!t&&e.length>0&&(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"You've reached the end of the apparatus list"})}),(0,a.jsx)(eJ,{open:!!o,onOpenChange:()=>c(null),children:(0,a.jsxs)(eZ,{className:"sm:max-w-[425px] rounded-lg p-6",children:[(0,a.jsx)(eX,{className:"pb-4",children:(0,a.jsxs)(e4,{className:"text-lg font-semibold",children:["Edit Apparatus #",null==o?void 0:o.id]})}),o&&(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{className:"grid gap-4",children:["sys","dia","map","pulse_rate_note"].map(e=>{var s;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium capitalize block mb-1",children:e.replace("_"," ")}),(0,a.jsx)(ez.p,{value:null!==(s=o[e])&&void 0!==s?s:"",onChange:s=>c({...o,[e]:s.target.value})})]},e)})})}),(0,a.jsxs)(e0,{className:"mt-6 flex justify-end gap-2",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:()=>c(null),children:"Cancel"}),(0,a.jsx)(p.$,{onClick:async()=>{o&&(await d({id:o.id,updates:{patient:o.patient,sys:o.sys,dia:o.dia,map:o.map,pulse_rate_note:o.pulse_rate_note}}),c(null))},children:"Update"})]})]})}),(0,a.jsx)(eJ,{open:!!m,onOpenChange:()=>u(null),children:(0,a.jsxs)(eZ,{className:"sm:max-w-3xl p-4",children:[(0,a.jsx)(eX,{children:(0,a.jsx)(e4,{children:"Apparatus Image"})}),(0,a.jsx)("div",{className:"flex justify-center",children:m&&(0,a.jsx)("img",{src:m,alt:"Enlarged Apparatus",className:"w-full h-auto object-contain max-h-[80vh] rounded-md"})}),(0,a.jsx)(e0,{className:"mt-4",children:(0,a.jsx)(p.$,{onClick:()=>u(null),children:"Close"})})]})})]})}function am(e){let{user:s,onLogout:t}=e,[n,l]=(0,r.useState)(!1),[i,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)("overview");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tP,{user:s,onLogout:()=>l(!0),activeView:o,setActiveView:c}),(0,a.jsx)(tA,{isOpen:n,onOpenChange:l,title:"Sign out",description:"Are you sure you want to sign out?",isConfirming:i,onConfirm:()=>{d(!0),t()}}),(0,a.jsxs)(h.sF,{className:"flex flex-col h-screen overflow-hidden",children:[(0,a.jsxs)("header",{className:"sticky top-0 z-20 flex h-16 items-center gap-2 border-b px-4 shadow-sm",children:[(0,a.jsx)(h.x2,{className:"-ml-1"}),(0,a.jsx)("span",{className:"text-lg text-muted-foreground",children:"Nurse Dashboard"})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto ".concat(""),children:(()=>{switch(o){case"overview":return(0,a.jsx)(tk,{title:"Nurse Overview"});case"patients":return(0,a.jsx)(sE,{});case"robots":return(0,a.jsx)(eb,{});case"management":return(0,a.jsx)(tu,{});case"waypoints":return(0,a.jsx)(tM,{});case"videos":return(0,a.jsx)(an,{});case"apparatus":return(0,a.jsx)(ac,{});case"scheduler":return(0,a.jsx)(t5,{});case"map":return(0,a.jsx)(sY,{});default:return(0,a.jsx)(tk,{title:""})}})()})]})]})}function au(){let{user:e,logout:s,loading:t}=(0,l.A)(),i=(0,n.useRouter)();return((0,r.useEffect)(()=>{t||e||i.push("/login")},[e,i,t]),e)?"admin"===e.role?(0,a.jsx)(tE,{user:e,onLogout:s}):(0,a.jsx)(am,{user:e,onLogout:s}):(0,a.jsx)("div",{className:"flex w-full items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-pink-400 animate-bounce"}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-pink-400 animate-bounce",style:{animationDelay:"-0.3s"}}),(0,a.jsx)("div",{className:"w-4 h-4 rounded-full bg-pink-400 animate-bounce",style:{animationDelay:"-0.5s"}})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[765,55,989,426,441,684,358],()=>s(3381)),_N_E=e.O()}]);